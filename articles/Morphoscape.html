<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Morphoscape">
<title>Morphoscape • Morphoscape</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Morphoscape">
<meta property="og:description" content="Morphoscape">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Morphoscape</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/Morphoscape.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Pareto.html">Pareto</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Morphoscape</h1>
            
      
      
      <div class="d-none name"><code>Morphoscape.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://blakedickson.github.io/Morphoscape/">Morphoscape</a></span><span class="op">)</span></span></code></pre></div>
<p>The following provides a guide on the workflow of performing an
adaptive landscape analysis, from the philosophies of morphospaces, and
types of data required, to the details of how to use the functions in
this “Morphoscape” package. This guide will cover the following
topics:</p>
<pre><code>1. Defining a Morphospace
  - Phenotype
  - Performance data: Specimens or Warps
2. Using Morphoscape
  - Creating Performance Surfaces
  - Calculate Landscapes</code></pre>
<div class="section level2">
<h2 id="defining-a-morphospace">Defining a morphospace<a class="anchor" aria-label="anchor" href="#defining-a-morphospace"></a>
</h2>
<div class="section level3">
<h3 id="phenotype">Phenotype<a class="anchor" aria-label="anchor" href="#phenotype"></a>
</h3>
<p>Adaptive landscape analyses require two types of data to be married
together: phenotypic data and performance data. Phenotype data can take
many forms, and the only requirement of phenotype data to the
construction of adaptive landscapes is the definition of a morphospace.
The simplest type of morphospace can be a 2D plot with the axes defined
by two numeric measurements of phenotype, such as the length and width
of a skull, though any quantification of phenotype is valid.</p>
<p>Geometric morphometrics has become the quintessential method for
quantifying detailed shape variation in bony structures, and the final
outcome in many studies is the visualization of a PCA of shape variation
- which is a morphospace. However, how one defines the morphospace can
drastically impact the outcomes of these adaptive landscape analyses. A
PCA and between-group PCA are both valid methods to ordinate
morphological data, yet will produce dramatically different morphospaces
depending on the goals of the analysis. PCA will produce a (largely)
unbiased ordination of the major axes of variation, while bgPCA will
find axes of variation that maximize differences in groups. Caution
should be applied when using constrained ordination like bgPCA, as they
can create ecological patterns where none may actually exist (see
Bookstein 2019, Cardini et al 2019 and Cardini &amp; Polly 2020 for the
cautionary debate). However, in many ways bgPCA, or other constrained
ordinations are ideal for questions regarding functional and adaptive
differences between ecological groups when actual morphological
differences are present.</p>
<p>For now the adaptive landscape methods in this package are limited to
2D morphospaces, with two axes of phenotypic variation. This largely
done out of the complexities involved in analyzing and visualizing
multivariate covariance in more than 3 dimensions. However, if more than
two axes of phenotypic variation are desired to be analyzed, these can
be done in separate analyses.</p>
</div>
<div class="section level3">
<h3 id="collecting-performance-data-specimens-or-warps">Collecting performance data: Specimens or Warps<a class="anchor" aria-label="anchor" href="#collecting-performance-data-specimens-or-warps"></a>
</h3>
<p>Once an ordination and 2D morphospace of the phenotypic data is
defined, one must then collect data on performance of these phenotypes.
There are two approaches one can take to collecting performance data:
collect data directly from specimens, or collect data from phenotypic
warps in morphospace. The former is the simplest and most direct as long
as your dataset is not too large, and allows you to to know actual
performance of actual specimens. However, error can creep in if the
performance traits do not strongly covary with the axes of your
morphospace, and can produce uneven and inconsistent surfaces. In
addition, specimens may not evenly occupy morphospace resulting in
regions of morphospace not defined by existing phenotypes, and thus will
not have measured performance data and may produce erroneous
interpolations or extrapolations of performance. Finally, collecting
performance data can be time consuming, and may be impractical for
extremely large datasets.</p>
<p>The alternative is to collect performance data from hypothetical
warps across morphospace, which eliminates these issues. As long as the
method used to define your morphospace is reversible (such as
<code>prcomp</code>, <code>geomorph::gm.prcomp</code>,
<code>Morpho::prcompfast</code>, <code>Morpho::groupPCA</code>,
<code>Morpho::CVA</code>), it is possible to extract the phenotype at
any location in morphospace. In fact many of these ordination functions
come with <code>predict</code> methods for this very task. As such,
using prediction, it is possible to define phenotypes evenly across all
of morphospace called warps. These warps are also useful in they can be
defined to represent phenotypic variation for ONLY the axes of the
morphospace, and ignore variation in other axes. These warps can however
form biologically impossible phenotypes (such as the walls of a bone
crossing over one another), which may or may not help your
interpretations of why regions of morphospace might be occupied or
not.</p>
<p>Both these approaches are valid as long as morphospace is reasonably
well covered. For an in-depth analysis of morphospace sampling see Smith
et al (2021).</p>
<p>This package comes with the turtle humerus dataset from Dickson and
Pierce (2019), which uses performance data collected from warps.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"turtles"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"warps"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    40 obs. of  4 variables:</span></span>
<span><span class="co">#&gt;  $ x      : num  0.03486 -0.07419 -0.07846 0.00972 -0.00997 ...</span></span>
<span><span class="co">#&gt;  $ y      : num  -0.019928 -0.015796 -0.010289 -0.000904 -0.029465 ...</span></span>
<span><span class="co">#&gt;  $ Group  : chr  "freshwater" "softshell" "softshell" "freshwater" ...</span></span>
<span><span class="co">#&gt;  $ Ecology: chr  "S" "S" "S" "S" ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">warps</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    24 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ x    : num  -0.189 -0.189 -0.189 -0.189 -0.134 ...</span></span>
<span><span class="co">#&gt;  $ y    : num  -0.05161 -0.00363 0.04435 0.09233 -0.05161 ...</span></span>
<span><span class="co">#&gt;  $ hydro: num  -1839 -1962 -2089 -2371 -1754 ...</span></span>
<span><span class="co">#&gt;  $ curve: num  8.07 6.3 9.7 15.44 10.21 ...</span></span>
<span><span class="co">#&gt;  $ mech : num  0.185 0.193 0.191 0.161 0.171 ...</span></span>
<span><span class="co">#&gt;  $ fea  : num  -0.15516 -0.06215 -0.00435 0.14399 0.28171 ...</span></span></code></pre></div>
<p><code>turtles</code> is a dataset of coordinate data for 40 turtle
humerus specimens that have been ordinated in a bgPCA morphospace, the
first two axes maximizing the differences between three ecological
groups: Marine, Freshwater and Terrestrial turtles. This dataset also
includes these and other ecological groupings.</p>
<p><code>warps</code> is a dataset of 4x6 evenly spaced warps predicted
from this morphospace and 4 performance metrics.</p>
</div>
</div>
<div class="section level2">
<h2 id="using-morphoscape">Using Morphoscape<a class="anchor" aria-label="anchor" href="#using-morphoscape"></a>
</h2>
<p>Once a morphospace is defined and performance data collected, the
workflow of using Morphoscape is fairly straightforward. Using the
<code>warp</code> and <code>turtles</code> datasets the first step is to
make a functional dataframe using <code><a href="../reference/as_fnc_df.html">as_fnc_df()</a></code>. The input to
this function is a dataframe containing both coordinate data and
performance data (and also grouping factors if desired). The first two
columns must be coordinates, while the other columns can be defined as
performance data, or as grouping factors. It is best to have your
performance data named at this point to keep track.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://blakedickson.github.io/Morphoscape/">Morphoscape</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"turtles"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"warps"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    40 obs. of  4 variables:</span></span>
<span><span class="co">#&gt;  $ x      : num  0.03486 -0.07419 -0.07846 0.00972 -0.00997 ...</span></span>
<span><span class="co">#&gt;  $ y      : num  -0.019928 -0.015796 -0.010289 -0.000904 -0.029465 ...</span></span>
<span><span class="co">#&gt;  $ Group  : chr  "freshwater" "softshell" "softshell" "freshwater" ...</span></span>
<span><span class="co">#&gt;  $ Ecology: chr  "S" "S" "S" "S" ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">warps</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    24 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ x    : num  -0.189 -0.189 -0.189 -0.189 -0.134 ...</span></span>
<span><span class="co">#&gt;  $ y    : num  -0.05161 -0.00363 0.04435 0.09233 -0.05161 ...</span></span>
<span><span class="co">#&gt;  $ hydro: num  -1839 -1962 -2089 -2371 -1754 ...</span></span>
<span><span class="co">#&gt;  $ curve: num  8.07 6.3 9.7 15.44 10.21 ...</span></span>
<span><span class="co">#&gt;  $ mech : num  0.185 0.193 0.191 0.161 0.171 ...</span></span>
<span><span class="co">#&gt;  $ fea  : num  -0.15516 -0.06215 -0.00435 0.14399 0.28171 ...</span></span>
<span></span>
<span><span class="co"># Create an fnc_df object for downstream use</span></span>
<span><span class="va">warps_fnc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_fnc_df.html">as_fnc_df</a></span><span class="op">(</span><span class="va">warps</span>, func.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hydro"</span>, <span class="st">"curve"</span>, <span class="st">"mech"</span>, <span class="st">"fea"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">warps_fnc</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classes 'fnc_df' and 'data.frame':   24 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ x    : num  -0.189 -0.189 -0.189 -0.189 -0.134 ...</span></span>
<span><span class="co">#&gt;  $ y    : num  -0.05161 -0.00363 0.04435 0.09233 -0.05161 ...</span></span>
<span><span class="co">#&gt;  $ hydro: num  0.763 0.627 0.487 0.174 0.858 ...</span></span>
<span><span class="co">#&gt;  $ curve: num  0.0544 0 0.1045 0.281 0.1202 ...</span></span>
<span><span class="co">#&gt;  $ mech : num  0.359 0.473 0.446 0 0.149 ...</span></span>
<span><span class="co">#&gt;  $ fea  : num  0.372 0.458 0.512 0.65 0.777 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "func.names")= chr [1:4] "hydro" "curve" "mech" "fea"</span></span></code></pre></div>
<div class="section level3">
<h3 id="creating-performance-surfaces">Creating Performance Surfaces<a class="anchor" aria-label="anchor" href="#creating-performance-surfaces"></a>
</h3>
<p>It is then a simple process to perform surface interpolation by
automatic Kriging using the <code><a href="../reference/krige_surf.html">krige_surf()</a></code> function. This
will autofit a kriging function to the data. This is performed by the
<code><a href="https://rdrr.io/pkg/automap/man/autoKrige.html" class="external-link">automap::autoKrige()</a></code> function. For details on the fitting
of variograms you should read the documentation of <code>automap</code>.
All the <code>autoKrige</code> fitting data is kept in the
<code>kriged_surfaces</code> object along with the output surface.</p>
<p>By default the <code><a href="../reference/krige_surf.html">krige_surf()</a></code> function will interpolate
within an alpha hull wrapped around the inputted datapoints. This is to
avoid extrapolation beyond measured datapoints. This can be defined
using the <code><a href="../reference/resample_grid.html">resample_grid()</a></code> function, which will supply a
grid object defining the points to interpolate, and optionally plot the
area to be reconstructed. The strength of wrapping can be controlled
using the <code>alpha</code> argument, with smaller values producing a
stronger wrapping.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create alpha-hulled grid for kriging</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resample_grid.html">resample_grid</a></span><span class="op">(</span><span class="va">warps</span>, hull <span class="op">=</span> <span class="st">"concaveman"</span>, alpha <span class="op">=</span> <span class="fl">3</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Morphoscape_files/figure-html/unnamed-chunk-4-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kr_surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/krige_surf.html">krige_surf</a></span><span class="op">(</span><span class="va">warps_fnc</span>, grid <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="va">kr_surf</span></span>
<span><span class="co">#&gt; A kriged_surfaces object</span></span>
<span><span class="co">#&gt; - functional characteristics:</span></span>
<span><span class="co">#&gt;  hydro, curve, mech, fea</span></span>
<span><span class="co">#&gt; - surface size:</span></span>
<span><span class="co">#&gt;  70 by 70</span></span>
<span><span class="co">#&gt;  α-hull applied (α = 3)</span></span>
<span><span class="co">#&gt; - original data:</span></span>
<span><span class="co">#&gt;  24 rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kr_surf</span><span class="op">)</span></span></code></pre></div>
<p><img src="Morphoscape_files/figure-html/unnamed-chunk-4-2.png" width="768" style="display: block; margin: auto;"></p>
<p>However, if one wishes to also extrapolate to the full extent of
morphospace, set <code>hull = NULL</code>. Because the
<code>warps</code> dataset evenly samples morphospace, we can set
<code>hull = NULL</code> and reconstruct the full rectangle of
morphospace. When <code>hull = NULL</code> an amount of padding will
also be applied to provide some space beyond the supplied datapoints and
can be controlled using the <code>padding</code> argument. Finally, we
can also specify the density of interpolated points using the
<code>resample</code> argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create alpha-hulled grid for kriging</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resample_grid.html">resample_grid</a></span><span class="op">(</span><span class="va">warps</span>, hull <span class="op">=</span> <span class="cn">NULL</span>, padding <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do the kriging on the grid</span></span>
<span><span class="va">kr_surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/krige_surf.html">krige_surf</a></span><span class="op">(</span><span class="va">warps_fnc</span>, grid <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="va">kr_surf</span></span>
<span><span class="co">#&gt; A kriged_surfaces object</span></span>
<span><span class="co">#&gt; - functional characteristics:</span></span>
<span><span class="co">#&gt;  hydro, curve, mech, fea</span></span>
<span><span class="co">#&gt; - surface size:</span></span>
<span><span class="co">#&gt;  100 by 100</span></span>
<span><span class="co">#&gt; - original data:</span></span>
<span><span class="co">#&gt;  24 rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kr_surf</span><span class="op">)</span></span></code></pre></div>
<p><img src="Morphoscape_files/figure-html/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;"></p>
<p>This reconstructed surface is missing actual specimen data points
with associated ecological groupings, which are needed for later
analyses. These can be added using the <code><a href="../reference/krige_surf.html">krige_new_data()</a></code>
function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Do kriging on the sample dataset</span></span>
<span><span class="va">kr_surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/krige_surf.html">krige_new_data</a></span><span class="op">(</span><span class="va">kr_surf</span>, new_data <span class="op">=</span> <span class="va">turtles</span><span class="op">)</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="va">kr_surf</span></span>
<span><span class="co">#&gt; A kriged_surfaces object</span></span>
<span><span class="co">#&gt; - functional characteristics:</span></span>
<span><span class="co">#&gt;  hydro, curve, mech, fea</span></span>
<span><span class="co">#&gt; - surface size:</span></span>
<span><span class="co">#&gt;  100 by 100</span></span>
<span><span class="co">#&gt; - original data:</span></span>
<span><span class="co">#&gt;  24 rows</span></span>
<span><span class="co">#&gt; - new data:</span></span>
<span><span class="co">#&gt;  40 rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kr_surf</span><span class="op">)</span></span></code></pre></div>
<p><img src="Morphoscape_files/figure-html/unnamed-chunk-6-1.png" width="768" style="display: block; margin: auto;"></p>
<p>This of course all can all be done in one step.
<code>krige_surf</code> will automatically call
<code><a href="../reference/resample_grid.html">resample_grid()</a></code> if no <code>grid</code> argument is
supplied, and <code>new_data</code> can be supplied as the data by which
later group optimums are calculated against.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Above steps all in one:</span></span>
<span><span class="va">kr_surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/krige_surf.html">krige_surf</a></span><span class="op">(</span><span class="va">warps_fnc</span>, hull <span class="op">=</span> <span class="cn">NULL</span>, padding <span class="op">=</span> <span class="fl">1.1</span>,</span>
<span>                      new_data <span class="op">=</span> <span class="va">turtles</span><span class="op">)</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="va">kr_surf</span></span>
<span><span class="co">#&gt; A kriged_surfaces object</span></span>
<span><span class="co">#&gt; - functional characteristics:</span></span>
<span><span class="co">#&gt;  hydro, curve, mech, fea</span></span>
<span><span class="co">#&gt; - surface size:</span></span>
<span><span class="co">#&gt;  100 by 100</span></span>
<span><span class="co">#&gt; - original data:</span></span>
<span><span class="co">#&gt;  24 rows</span></span>
<span><span class="co">#&gt; - new data:</span></span>
<span><span class="co">#&gt;  40 rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kr_surf</span><span class="op">)</span></span></code></pre></div>
<p><img src="Morphoscape_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="calculate-landscapes">Calculate Landscapes<a class="anchor" aria-label="anchor" href="#calculate-landscapes"></a>
</h3>
<p>The next step is to calculate a distribution of adaptive landscapes.
Each adaptive landscape is constructed as the summation of the
performance surfaces in differing magnitudes, Each performance surface
is multiplied by a weight ranging from 0-1, and the total sum of weights
is equal to 1. For four equally weighted performance surfaces, the
weights would be the vector <code>c(0.25, 0.25, 0.25, 0.25)</code>. To
generate a distribution of different combinations of these weights, use
the <code><a href="../reference/generate_weights.html">generate_weights()</a></code> function.
<code>generate_weights</code> must have either a <code>step</code> or
<code>n</code> argument to determine how many allocations to generate,
and <code>nvar</code> the number of variables. One can also provide
either the <code>fnc_df</code> or <code>kr_surf</code> objects to the
<code>data</code> argument. <code>step</code> determines the step size
between weight values. <code>step = 0.1</code> will generate a vectors
of <code>c(0, 0.1, 0.2 ... 1)</code>. Alternatively, one can set the
number of values in the sequence set. <code>n = 10</code> will generate
the same vectors of <code>c(0, 0.1, 0.2 ... 1)</code>. The function will
then generate all combinations of <code>nvar</code> variables that sum
to 1.</p>
<p>For four variables, this will produce 286 combinations. A step size
of 0.05 will produce 1771 rows. As the step size gets smaller, and the
number of variables increases, the number of output rows will
exponentially increase. It is recommended to start with large
<code>step</code> sizes, or small <code>n</code> to ensure things are
working correctly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate weights to search for optimal landscapes</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_weights.html">generate_weights</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, nvar <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; 286 rows generated</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_weights.html">generate_weights</a></span><span class="op">(</span>step <span class="op">=</span> <span class="fl">0.05</span> , data <span class="op">=</span> <span class="va">kr_surf</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1771 rows generated</span></span></code></pre></div>
<p>This <code>weights</code> matrix is then provided to the
<code>calc_all_landscapes()</code> along with the <code>kr_surf</code>
object to calculate the landscapes for each set of weights. For
calculations with a large number of weights, outputs can take some time
and can be very large in size, and it is recommended to utilize the
<code>file</code> argument to save the output to file.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate all landscapes; setting verbose = TRUE produces</span></span>
<span><span class="co"># a progress bar</span></span>
<span><span class="va">all_landscapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_all_lscps.html">calc_all_lscps</a></span><span class="op">(</span><span class="va">kr_surf</span>, grid_weights <span class="op">=</span> <span class="va">weights</span><span class="op">)</span></span></code></pre></div>
<p>With a distribution of landscapes, it is now possible to find
landscapes that maximize ‘fitness’ for a given subset or group of your
specimens in <code>new_data</code> using the <code><a href="../reference/calcWprimeBy.html">calcWprimeBy()</a></code>
function. The <code>by</code> argument sets the grouping variable for
the data provided in <code>new_data</code> from earlier. There are
several ways <code>by</code> can be set: A one sided formula containing
the name of a column in <code>new_data</code> or a vector containing a
factor variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate optimal landscapes by Group</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">$</span><span class="va">Ecology</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  M  S  T </span></span>
<span><span class="co">#&gt;  4 29  7</span></span>
<span></span>
<span><span class="va">wprime_by_Group</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcWprimeBy.html">calcWprimeBy</a></span><span class="op">(</span><span class="va">all_landscapes</span>, by <span class="op">=</span> <span class="op">~</span><span class="va">Ecology</span><span class="op">)</span></span>
<span><span class="va">wprime_by_Group</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcWprimeBy.html">calcWprimeBy</a></span><span class="op">(</span><span class="va">all_landscapes</span>, by <span class="op">=</span> <span class="va">turtles</span><span class="op">$</span><span class="va">Ecology</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wprime_by_Group</span></span>
<span><span class="co">#&gt; - turtles$Ecology == "M"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimal weights:</span></span>
<span><span class="co">#&gt;         Weight       SE      SD Min. Max.</span></span>
<span><span class="co">#&gt; hydro 0.104167 0.029167 0.10104  0.0 0.30</span></span>
<span><span class="co">#&gt; curve 0.008333 0.005618 0.01946  0.0 0.05</span></span>
<span><span class="co">#&gt; mech  0.012500 0.006528 0.02261  0.0 0.05</span></span>
<span><span class="co">#&gt; fea   0.875000 0.025746 0.08919  0.7 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average fitness value at optimal weights:</span></span>
<span><span class="co">#&gt;    Value       SE      SD   Min.   Max.</span></span>
<span><span class="co">#&gt; Z 0.7612 0.004671 0.01618 0.7437 0.7927</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; - turtles$Ecology == "S"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimal weights:</span></span>
<span><span class="co">#&gt;        Weight       SE      SD Min. Max.</span></span>
<span><span class="co">#&gt; hydro 0.85469 0.009878 0.05588  0.8 1.00</span></span>
<span><span class="co">#&gt; curve 0.05312 0.010025 0.05671  0.0 0.20</span></span>
<span><span class="co">#&gt; mech  0.05312 0.010025 0.05671  0.0 0.20</span></span>
<span><span class="co">#&gt; fea   0.03906 0.007691 0.04350  0.0 0.15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average fitness value at optimal weights:</span></span>
<span><span class="co">#&gt;    Value       SE      SD   Min.   Max.</span></span>
<span><span class="co">#&gt; Z 0.7491 0.002325 0.01315 0.7326 0.7835</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; - turtles$Ecology == "T"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimal weights:</span></span>
<span><span class="co">#&gt;       Weight      SE      SD Min. Max.</span></span>
<span><span class="co">#&gt; hydro 0.0125 0.00559 0.02236 0.00 0.05</span></span>
<span><span class="co">#&gt; curve 0.8500 0.02415 0.09661 0.65 1.00</span></span>
<span><span class="co">#&gt; mech  0.1250 0.02661 0.10646 0.00 0.35</span></span>
<span><span class="co">#&gt; fea   0.0125 0.00559 0.02236 0.00 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average fitness value at optimal weights:</span></span>
<span><span class="co">#&gt;    Value       SE      SD  Min.   Max.</span></span>
<span><span class="co">#&gt; Z 0.7538 0.003712 0.01485 0.736 0.7852</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - method: chi-squared, quantile = 0.05</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wprime_by_Group</span><span class="op">)</span></span>
<span><span class="co">#&gt; Optimal weights by turtles$Ecology:</span></span>
<span><span class="co">#&gt;    W_hydro  W_curve   W_mech    W_fea        Z</span></span>
<span><span class="co">#&gt; M 0.104167 0.008333 0.012500 0.875000 0.761245</span></span>
<span><span class="co">#&gt; S 0.854688 0.053125 0.053125 0.039062 0.749055</span></span>
<span><span class="co">#&gt; T 0.012500 0.850000 0.125000 0.012500 0.753825</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wprime_by_Group</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Morphoscape_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;"></p>
<p>It is also possible to use <code>calcGrpWprime</code> to enumerate a
single group or for the entire sample:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate landscapes for one Group at a time</span></span>
<span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">$</span><span class="va">Ecology</span> <span class="op">==</span> <span class="st">"T"</span><span class="op">)</span></span>
<span><span class="va">wprime_T</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcGrpWprime.html">calcGrpWprime</a></span><span class="op">(</span><span class="va">all_landscapes</span>, index <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span><span class="va">wprime_T</span></span>
<span><span class="co">#&gt; Optimal weights:</span></span>
<span><span class="co">#&gt;       Weight      SE      SD Min. Max.</span></span>
<span><span class="co">#&gt; hydro 0.0125 0.00559 0.02236 0.00 0.05</span></span>
<span><span class="co">#&gt; curve 0.8500 0.02415 0.09661 0.65 1.00</span></span>
<span><span class="co">#&gt; mech  0.1250 0.02661 0.10646 0.00 0.35</span></span>
<span><span class="co">#&gt; fea   0.0125 0.00559 0.02236 0.00 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average fitness value at optimal weights:</span></span>
<span><span class="co">#&gt;    Value       SE      SD  Min.   Max.</span></span>
<span><span class="co">#&gt; Z 0.7538 0.003712 0.01485 0.736 0.7852</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - method: chi-squared, quantile = 0.05</span></span>
<span><span class="va">wprime_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcGrpWprime.html">calcGrpWprime</a></span><span class="op">(</span><span class="va">all_landscapes</span>, <span class="va">Group</span> <span class="op">==</span> <span class="st">"box turtle"</span><span class="op">)</span></span>
<span><span class="va">wprime_b</span></span>
<span><span class="co">#&gt; Optimal weights:</span></span>
<span><span class="co">#&gt;        Weight       SE      SD Min. Max.</span></span>
<span><span class="co">#&gt; hydro 0.01944 0.007162 0.03038  0.0  0.1</span></span>
<span><span class="co">#&gt; curve 0.86944 0.018140 0.07696  0.7  1.0</span></span>
<span><span class="co">#&gt; mech  0.09167 0.021862 0.09275  0.0  0.3</span></span>
<span><span class="co">#&gt; fea   0.01944 0.007162 0.03038  0.0  0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average fitness value at optimal weights:</span></span>
<span><span class="co">#&gt;    Value       SE      SD   Min.   Max.</span></span>
<span><span class="co">#&gt; Z 0.7746 0.003492 0.01482 0.7565 0.8073</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - method: chi-squared, quantile = 0.05</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wprime_b</span><span class="op">)</span></span></code></pre></div>
<p><img src="Morphoscape_files/figure-html/unnamed-chunk-11-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">wprime_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcGrpWprime.html">calcGrpWprime</a></span><span class="op">(</span><span class="va">all_landscapes</span><span class="op">)</span></span>
<span><span class="va">wprime_all</span></span>
<span><span class="co">#&gt; Optimal weights:</span></span>
<span><span class="co">#&gt;        Weight       SE      SD Min. Max.</span></span>
<span><span class="co">#&gt; hydro 0.74853 0.008797 0.08885  0.6 1.00</span></span>
<span><span class="co">#&gt; curve 0.10735 0.009984 0.10084  0.0 0.40</span></span>
<span><span class="co">#&gt; mech  0.08578 0.008342 0.08425  0.0 0.35</span></span>
<span><span class="co">#&gt; fea   0.05833 0.006156 0.06217  0.0 0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average fitness value at optimal weights:</span></span>
<span><span class="co">#&gt;    Value       SE      SD   Min. Max.</span></span>
<span><span class="co">#&gt; Z 0.6343 0.001179 0.01191 0.6193 0.67</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - method: chi-squared, quantile = 0.05</span></span></code></pre></div>
<p>Finally, it is possible to compare the landscapes for each group
using <code><a href="../reference/calcGrpWprime.html">calcGrpWprime()</a></code>. This is done by comparing the number
of landscape combinations are shared by the upper percentile between
groups.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Test for differences between Group landscapes</span></span>
<span><span class="va">tests</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lands.grp.test.html">multi.lands.grp.test</a></span><span class="op">(</span><span class="va">wprime_by_Group</span><span class="op">)</span></span>
<span><span class="va">tests</span></span>
<span><span class="co">#&gt; Pairwise landscape group tests</span></span>
<span><span class="co">#&gt; - method: chi-squared | quantile: 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results:</span></span>
<span><span class="co">#&gt;   M S T</span></span>
<span><span class="co">#&gt; M - 0 0</span></span>
<span><span class="co">#&gt; S 0 - 0</span></span>
<span><span class="co">#&gt; T 0 0 -</span></span>
<span><span class="co">#&gt; (lower triangle: p-values | upper triangle: number of matches)</span></span>
<span></span>
<span><span class="co"># Calculate landscapes for one Group at a time</span></span>
<span><span class="va">wprime_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcGrpWprime.html">calcGrpWprime</a></span><span class="op">(</span><span class="va">all_landscapes</span>, <span class="va">Group</span> <span class="op">==</span> <span class="st">"box turtle"</span><span class="op">)</span></span>
<span><span class="va">wprime_b</span></span>
<span><span class="co">#&gt; Optimal weights:</span></span>
<span><span class="co">#&gt;        Weight       SE      SD Min. Max.</span></span>
<span><span class="co">#&gt; hydro 0.01944 0.007162 0.03038  0.0  0.1</span></span>
<span><span class="co">#&gt; curve 0.86944 0.018140 0.07696  0.7  1.0</span></span>
<span><span class="co">#&gt; mech  0.09167 0.021862 0.09275  0.0  0.3</span></span>
<span><span class="co">#&gt; fea   0.01944 0.007162 0.03038  0.0  0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average fitness value at optimal weights:</span></span>
<span><span class="co">#&gt;    Value       SE      SD   Min.   Max.</span></span>
<span><span class="co">#&gt; Z 0.7746 0.003492 0.01482 0.7565 0.8073</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - method: chi-squared, quantile = 0.05</span></span>
<span><span class="va">wprime_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcGrpWprime.html">calcGrpWprime</a></span><span class="op">(</span><span class="va">all_landscapes</span>, <span class="va">Group</span> <span class="op">==</span> <span class="st">"tortoise"</span><span class="op">)</span></span>
<span><span class="va">wprime_t</span></span>
<span><span class="co">#&gt; Optimal weights:</span></span>
<span><span class="co">#&gt;        Weight       SE      SD Min. Max.</span></span>
<span><span class="co">#&gt; hydro 0.01176 0.005302 0.02186 0.00 0.05</span></span>
<span><span class="co">#&gt; curve 0.85294 0.022877 0.09432 0.65 1.00</span></span>
<span><span class="co">#&gt; mech  0.11765 0.026059 0.10744 0.00 0.35</span></span>
<span><span class="co">#&gt; fea   0.01765 0.007353 0.03032 0.00 0.10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average fitness value at optimal weights:</span></span>
<span><span class="co">#&gt;    Value       SE      SD   Min.   Max.</span></span>
<span><span class="co">#&gt; Z 0.7008 0.003571 0.01472 0.6829 0.7325</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - method: chi-squared, quantile = 0.05</span></span>
<span></span>
<span><span class="co"># Test for differences between Group landscapes</span></span>
<span><span class="fu"><a href="../reference/lands.grp.test.html">lands.grp.test</a></span><span class="op">(</span><span class="va">wprime_b</span>, <span class="va">wprime_t</span><span class="op">)</span></span>
<span><span class="co">#&gt; Landscape group test</span></span>
<span><span class="co">#&gt; - method: chi-squared | quantile: 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of matches: 16</span></span>
<span><span class="co">#&gt; P-value: 0.8889</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Bookstein, F. L. (2019). Pathologies of between-groups principal
components analysis in geometric morphometrics. Evolutionary Biology,
46(4), 271-302.</p>
<p>Cardini, A., O’Higgins, P., &amp; Rohlf, F. J. (2019). Seeing
distinct groups where there are none: spurious patterns from
between-group PCA. Evolutionary Biology, 46(4), 303-316.</p>
<p>Cardini, A., &amp; Polly, P. D. (2020). Cross-validated between group
PCA scatterplots: A solution to spurious group separation?. Evolutionary
Biology, 47(1), 85-95.</p>
<p>Dickson, B. V., &amp; Pierce, S. E. (2019). Functional performance of
turtle humerus shape across an ecological adaptive landscape. Evolution,
73(6), 1265-1277.</p>
<p>Smith, S. M., Stayton, C. T., &amp; Angielczyk, K. D. (2021). How
many trees to see the forest? Assessing the effects of morphospace
coverage and sample size in performance surface analysis. Methods in
Ecology and Evolution, 12(8), 1411-1424.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Blake Dickson, Stephanie Pierce, Noah Greifer, Robert Brocklehurst.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
