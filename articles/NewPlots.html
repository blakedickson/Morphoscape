<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Morphoscape">
<title>Plotting • Morphoscape</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting">
<meta property="og:description" content="Morphoscape">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Morphoscape</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/Morphoscape.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/NewPlots.html">Plotting</a>
    <a class="dropdown-item" href="../articles/Pareto.html">Pareto</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plotting</h1>
            
      
      
      <div class="d-none name"><code>NewPlots.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://blakedickson.github.io/Morphoscape/">Morphoscape</a></span><span class="op">)</span></span></code></pre></div>
<p>We’ll now demonstrate some extra features of Mophoscape for plotting
and working with performance surfaces and landscapes.</p>
<p>In this example dataset, we have morpholoigcal data for each turtle
species, but the performance variables were measured across a grid of
theoretical ‘warp’ models. We don’t have performance data measured for
each individual specimen, but we can extract performance data based on
the specimen’s position in morphospace and its height on the
reconstructed performance surface.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"turtles"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"warps"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an fnc_df object for downstream use</span></span>
<span><span class="va">warps_fnc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_fnc_df.html">as_fnc_df</a></span><span class="op">(</span><span class="va">warps</span>, func.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hydro"</span>, <span class="st">"curve"</span>, <span class="st">"mech"</span>, <span class="st">"fea"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Above steps all in one:</span></span>
<span><span class="va">kr_surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/krige_surf.html">krige_surf</a></span><span class="op">(</span><span class="va">warps_fnc</span>, hull <span class="op">=</span> <span class="cn">NULL</span>, padding <span class="op">=</span> <span class="fl">1.1</span>,new_data <span class="op">=</span> <span class="va">turtles</span><span class="op">)</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span>
<span><span class="co">#&gt; [using ordinary kriging]</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kr_surf</span><span class="op">)</span></span></code></pre></div>
<p><img src="NewPlots_files/figure-html/unnamed-chunk-2-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Below, we extract these values from the performance surface grid, and
then plot them according the species ecology.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">turtles_kr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sp_vals_from_grid.html">sp_vals_from_grid</a></span><span class="op">(</span><span class="va">kr_surf</span>, <span class="va">turtles</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">turtles_kr</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Ecology</span>, y <span class="op">=</span> <span class="va">curve</span>, fill <span class="op">=</span> <span class="va">Ecology</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span></span></code></pre></div>
<p><img src="NewPlots_files/figure-html/unnamed-chunk-4-1.png" width="768" style="display: block; margin: auto;"></p>
<p>We can do the same thing for the height of a set of species on an
adaptive landscape. First, let’s generate the adaptive landscapes based
on ecology (marine, semi-aquatic and terrestrial).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_weights.html">generate_weights</a></span><span class="op">(</span>step <span class="op">=</span> <span class="fl">0.05</span> , data <span class="op">=</span> <span class="va">kr_surf</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1771 rows generated</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_landscapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_all_lscps.html">calc_all_lscps</a></span><span class="op">(</span><span class="va">kr_surf</span>, grid_weights <span class="op">=</span> <span class="va">weights</span><span class="op">)</span></span>
<span><span class="va">wprime_by_Group</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcWprimeBy.html">calcWprimeBy</a></span><span class="op">(</span><span class="va">all_landscapes</span>, by <span class="op">=</span> <span class="op">~</span><span class="va">Ecology</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wprime_by_Group</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="NewPlots_files/figure-html/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;"></p>
<p>And now, We can extract the heights of each specimen on each
landscape and then plot. Let’s see how well species from each ecological
grouping do on the marine turtle landscape.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">turtles_lscp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sp_vals_from_grid.html">sp_vals_from_grid</a></span><span class="op">(</span><span class="va">wprime_by_Group</span>, <span class="va">turtles</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">turtles_lscp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Ecology</span>, y <span class="op">=</span> <span class="va">M</span>, fill <span class="op">=</span> <span class="va">Ecology</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span></span></code></pre></div>
<p><img src="NewPlots_files/figure-html/unnamed-chunk-6-1.png" width="768" style="display: block; margin: auto;"></p>
<p>As well as plotting by these variables grouped by ecology (or family,
or any other categorical variable) we can also plot the evolution of
performance values or landscape heights across a phylogeny.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools" class="external-link">phytools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ape</span></span>
<span><span class="co">#&gt; Loading required package: maps</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">turtles_tree</span><span class="op">)</span></span>
<span><span class="va">trait_values</span> <span class="op">&lt;-</span> <span class="va">turtles_lscp</span><span class="op">$</span><span class="va">M</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">trait_values</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">turtles_lscp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">turtle_cmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/phytools/man/contMap.html" class="external-link">contMap</a></span><span class="op">(</span><span class="va">turtles_tree</span>, <span class="va">trait_values</span>,plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">turtle_cmap</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/setMap.html" class="external-link">setMap</a></span><span class="op">(</span><span class="va">turtle_cmap</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'brown4'</span>,<span class="st">'beige'</span>,<span class="st">'lightblue'</span>,<span class="st">'blue'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">turtle_cmap</span><span class="op">)</span></span></code></pre></div>
<p><img src="NewPlots_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Blake Dickson, Stephanie Pierce, Noah Greifer, Robert Brocklehurst.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
