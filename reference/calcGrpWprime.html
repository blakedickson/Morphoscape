<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="calcGrpWprime() computes the optimally weighted adaptive landscape by searching through the adaptive landscapes formed from sets of weights and performance surfaces, and finding the set of weights that yields the greatest overall (average) fitness value (Z) across a sample of data or a subset thereof."><title>Compute optimally weighted adaptive landscapes — calcGrpWprime • Morphoscape</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute optimally weighted adaptive landscapes — calcGrpWprime"><meta property="og:description" content="calcGrpWprime() computes the optimally weighted adaptive landscape by searching through the adaptive landscapes formed from sets of weights and performance surfaces, and finding the set of weights that yields the greatest overall (average) fitness value (Z) across a sample of data or a subset thereof."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Morphoscape</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Morphoscape.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute optimally weighted adaptive landscapes</h1>
      
      <div class="d-none name"><code>calcGrpWprime.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>calcGrpWprime()</code> computes the optimally weighted adaptive landscape by searching through the adaptive landscapes formed from sets of weights and performance surfaces, and finding the set of weights that yields the greatest overall (average) fitness value (Z) across a sample of data or a subset thereof.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">calcGrpWprime</span><span class="op">(</span><span class="va">x</span>, <span class="va">index</span>, method <span class="op">=</span> <span class="st">"chi-squared"</span>,
              quantile <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co"># S3 method for grp_Wprime</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, 
      digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>for <code>calcGrpWprime()</code>, an <code>all_lscps</code> object; the output of a call to <code><a href="calc_all_lscps.html">calc_all_lscps</a></code>.</p>
<p>for <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>, a <code>grp_Wprime</code> object; the output of a call to <code>calcGrpWprime()</code></p></dd>

  <dt>index</dt>
<dd><p>an optional vector of indices indicating which subset of the <code>new_data</code> dataset originally supplied to <code><a href="krige_surf.html">krige_surf</a></code> should be calculated. Can be specified as a vector of numerical indicies, logical indices, or row names. If unspecified, the optimal weights will be computed using the full sample. Supplied to <code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></code>, so the name of the dataset containing the subsetting variable does not need to be included if the subsetting variable is in <code>new_data</code>. See Examples.</p></dd>

  <dt>method</dt>
<dd><p>the method used to compute the optimal weights. Allowable options include <code>"chi-square"</code> (the default), <code>"quantile"</code>, or <code>"max"</code>. <code>"chi-square"</code> and <code>"quantile"</code> involve averaging across the best several sets of weights, whereas <code>"max"</code> uses the singular best set of weights. Abbreviations allowed. See Details.</p></dd>

  <dt>quantile</dt>
<dd><p>when <code>method</code> is <code>"chi-square"</code> or <code>"quantile"</code>, the top quantile used to determine the best sets of weights to be included in the average to compute the optimal set of weights. Should be a number between 0 and 1, with a low value indicating that only the few top sets of weights will be used. Ignored when <code>method = "max"</code>.</p></dd>

  <dt>digits</dt>
<dd><p>the number of significant digits to print.</p></dd>

  <dt>...</dt>
<dd><p>passed to <code><a href="https://rdrr.io/r/base/print.default.html" class="external-link">print.default</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>calcGrpWprime()</code> calculates an overall fitness score for each set of weights based on the average weighted fitness values of the indexed subgroup. The set of weights that optimizes this score is then produced as the weights defining the optimal adaptive landscape for that subgroup. The way the final set of weights is computed depends on the argument to <code>method</code>. When <code>method = "max"</code>, the single best set of weights is used. However, often many of the upper sets of weights perform equally or nearly equally as well as the best set. It is instead recommended to use <code>"quantile"</code> or <code>"chi-squared"</code> methods. When <code>method = "quantile"</code>, the top \(X\%\) of weights are averaged to compute the optimal weights, where \(X\) corresponds to the value supplied to <code>quantile</code>. When <code>method = "chi-square"</code>,  the chi-squared value \(\chi^2_i\) is computed for each set of weights \(i\) as $$\chi^2_i = -2 \log \frac{Z_{max}}{Z_i}$$
where \(Z_{max}\) is the largest \(Z\) among the weights, and a p-value is computed for each \(\chi^2_i\) value using a \(\chi^2\) distribution with 2 d.f.; any set of weights with a p-value less than <code>quantile</code> is included to be averaged to compute the optimal set of weights.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>grp_Wprime</code> object, which contains the following components:</p>
<dl><dt>Zprime</dt>
<dd><p>a list containing the optimal weights and the Z value they yield (<code>wn</code>), and, if <code>method</code> is <code>"chi-square"</code> or <code>"quantile"</code>, summary statistics about the best sets of weights used to compute the optimal weights, including the standard error (<code>wn.se</code>), standard deviation (<code>wn.sd</code>), and range (<code>wn.range</code>).</p></dd>

<dt>W</dt>
<dd><p>a matrix containing all sets of weights (i.e., those supplied to the <code>grid_weights</code> argument of <code><a href="calc_all_lscps.html">calc_all_lscps()</a></code>) along with the Z value each yields, ordered in descending order by the yielded Z value. When <code>index</code> is specified, the resulting Z values are computed only using the indexed subset.</p></dd>

<dt>Wprime</dt>
<dd><p>a <code><a href="calc_lscp.html">wtd_lscp</a></code> object containing the optimal weights (<code>W</code>) and the landscape grid and sample functional characteristcs weighted by the optimal weights.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<p>Dickson, B. V., Clack, J. A., Smithson, T. R., &amp; Pierce, S. E. (2021). Functional adaptive landscapes predict terrestrial capacity at the origin of limbs. Nature, 589(7841), 242-245.</p>
<p>Jones, K. E., Dickson, B. V., Angielczyk, K. D., &amp; Pierce, S. E. (2021). Adaptive landscapes challenge the "lateral-to-sagittal"" paradigm for mammalian vertebral evolution. Current Biology, 31(9), 1883-1892.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="calc_all_lscps.html">calc_all_lscps</a></code> for computing the landscapes which are to be optimized.</p>
<p><code><a href="calcWprimeBy.html">calcWprimeBy</a></code> for finding optimal sets of weights for multiple subgroups defined by a subgrouping variable.</p>
<p><code><a href="plot.wtd_lscp.html">plot.grp_Wprime</a></code> for plotting the resulting adaptive landscape.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"warps"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"turtles"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">warps_fnc</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_fnc_df.html">as_fnc_df</a></span><span class="op">(</span><span class="va">warps</span>, </span>
<span class="r-in">                       func.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hydro"</span>, <span class="st">"fea"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">kr_surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="krige_surf.html">krige_surf</a></span><span class="op">(</span><span class="va">warps_fnc</span>, new_data <span class="op">=</span> <span class="va">turtles</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">grid_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_weights.html">generate_weights</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, data <span class="op">=</span> <span class="va">kr_surf</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4 rows generated</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">all_lscps</span> <span class="op">&lt;-</span> <span class="fu"><a href="calc_all_lscps.html">calc_all_lscps</a></span><span class="op">(</span><span class="va">kr_surf</span>,</span>
<span class="r-in">                            grid_weights <span class="op">=</span> <span class="va">grid_weights</span><span class="op">)</span></span>
<span class="r-in">                            </span>
<span class="r-in"><span class="va">wprime_S</span> <span class="op">&lt;-</span> <span class="fu">calcGrpWprime</span><span class="op">(</span><span class="va">all_lscps</span>,</span>
<span class="r-in">                          index <span class="op">=</span> <span class="va">Ecology</span> <span class="op">==</span> <span class="st">"S"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">wprime_S</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Weight SE SD Min. Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hydro      1 NA NA    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fea        0 NA NA    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average fitness value at optimal weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Value SE SD   Min.   Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z 0.7835 NA NA 0.7835 0.7835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - method: chi-squared, quantile = 0.05</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wprime_S</span><span class="op">)</span></span>
<span class="r-plt img"><img src="calcGrpWprime-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Blake Dickson, Stephanie Pierce, Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

