<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Significance tests between sets of weights — lands.grp.test • Morphoscape</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Significance tests between sets of weights — lands.grp.test"><meta name="description" content="lands.grp.test() performs a statistical test for whether the optimal adaptive landscape for two subgroups are significantly different from each other. The p-value of the test is the proportion of weight sets that are shared between the two subgroups among their respective top weight sets. multi.lands.grp.test() performs this test for all pairs of subgroups."><meta property="og:description" content="lands.grp.test() performs a statistical test for whether the optimal adaptive landscape for two subgroups are significantly different from each other. The p-value of the test is the proportion of weight sets that are shared between the two subgroups among their respective top weight sets. multi.lands.grp.test() performs this test for all pairs of subgroups."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Morphoscape</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Morphoscape.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/NewPlots.html">Plotting</a></li>
    <li><a class="dropdown-item" href="../articles/Pareto.html">Pareto</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Significance tests between sets of weights</h1>

      <div class="d-none name"><code>lands.grp.test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>lands.grp.test()</code> performs a statistical test for whether the optimal adaptive landscape for two subgroups are significantly different from each other. The p-value of the test is the proportion of weight sets that are shared between the two subgroups among their respective top weight sets. <code>multi.lands.grp.test()</code> performs this test for all pairs of subgroups.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lands.grp.test</span><span class="op">(</span><span class="va">grpa</span>, <span class="va">grpb</span>, method <span class="op">=</span> <span class="st">"chi-squared"</span>,</span>
<span>               quantile <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">multi.lands.grp.test</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"chi-squared"</span>,</span>
<span>                     quantile <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'lands.grp.test'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'multi.lands.grp.test'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3L</span><span class="op">)</span>, </span>
<span>      style <span class="op">=</span> <span class="st">"matrix"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-grpa-grpb">grpa, grpb<a class="anchor" aria-label="anchor" href="#arg-grpa-grpb"></a></dt>
<dd><p>for <code>lands.grp.test()</code>, the two <code>grp_Wprime</code> objects containing the adaptive landscapes to be compared; these are the output of calls to <code><a href="calcGrpWprime.html">calcGrpWprime</a></code>.</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>for <code>multi.lands.grp.test()</code>, a <code>by_Wprime</code> object, the output of a call to <code><a href="calcWprimeBy.html">calcWprimeBy</a></code>.</p>
<p>for <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>, the output of a call to <code>lands.grp.test()</code> or <code>multi.lands.grp.test()</code>.</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the method used to determine which sets of weights are in the "best" sets of weights that are to be comapred between the two groups. Allowable options include <code>"chi-squared"</code> and <code>"quantile"</code>. See <code><a href="calcGrpWprime.html">calcGrpWprime</a></code> for details.</p></dd>

  <dt id="arg-quantile">quantile<a class="anchor" aria-label="anchor" href="#arg-quantile"></a></dt>
<dd><p>the top quantile used to determine the best sets of weights to be included in the average to compute the optimal set of weights. Should be a number between 0 and 1, with a low value indicating that only the few top sets of weights will be used. See <code><a href="calcGrpWprime.html">calcGrpWprime</a></code> for details.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>the number of significant digits to print.</p></dd>

  <dt id="arg-style">style<a class="anchor" aria-label="anchor" href="#arg-style"></a></dt>
<dd><p>how to display the results of the pairwise tests; allowable options include <code>"matrix"</code> and <code>"table"</code>. Abbreviations allowed.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>passed to <code><a href="https://rdrr.io/r/base/print.default.html" class="external-link">print.default</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>lands.grp.test()</code> performs pairwise comparisons between two adaptive groups by comparing the number of shared landscapes \(n_{A+B}\) in the top percentile of each group with the total number of landscapes in this top percentile \(n_{total}\). The probability \(P(A=B)\) thus is calculated as:</p>
<p>$$
P(A=B) = n_{A+B}/n_{total}
$$</p>
<p>If <code>method = "quantile"</code> is used, then the top percentile is defined by <code>quantile</code>. If <code>method = "chi-squared"</code> is used, then the top percentile is calculated from the chi-squared value \(\chi^2_i\) as: $$\chi^2_i = -2 \log \frac{Z_{max}}{Z_i}$$ where \(Z_{max}\) is the largest \(Z\) among the weights, and a p-value is computed for each \(\chi^2_i\) value using a \(\chi^2\) distribution with 2 d.f.; any set of weights with a p-value less than <code>quantile</code> is included in the optimal set of weights.</p>
<p><code>multi.lands.grp.test()</code> is a wrapper for <code>lands.grp.test()</code>, applying the function pairwise to all combinations of groups calculated by <code><a href="calcWprimeBy.html">calcWprimeBy</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For <code>lands.grp.test()</code>, a <code>lands.grp.test</code> object containing the following components:</p>
<dl><dt>n.match</dt>
<dd><p>the number of sets of weights that match between the two supplied subgroups</p></dd>

<dt>p.val</dt>
<dd><p>the p-value of the test, computed as the number of sets of weights that match divided by the number of sets of weights compared</p></dd>

<dt>matching</dt>
<dd><p>a matrix containing the sets of weights that match between the two subgroups</p></dd>

<dt>method</dt>
<dd><p>the argument supplied to <code>method</code></p></dd>

<dt>quantile</dt>
<dd><p>the argument supplied to <code>quantile</code></p></dd>


</dl><p>For <code>multi.lands.grp.test()</code>, a <code>multi.lands.grp.test</code> object containing the following components:</p>
<dl><dt>res</dt>
<dd><p>a data frame containing the results of the tests, with the columns <code>Group A</code> and <code>Group B</code> indicating the groups involved in the comparison, the column <code>Matches</code> containing the number of matching sets of weights in the comparison, and the column <code>p value</code> containing the p-value of the test.</p></dd>

<dt>method</dt>
<dd><p>the argument supplied to <code>method</code></p></dd>

<dt>quantile</dt>
<dd><p>the argument supplied to <code>quantile</code></p></dd>


</dl><p>For <code>print.multi.lands.grp.test()</code>, setting <code>style = "table"</code> prints the <code>res</code> component as-is; setting <code>style = "matrix"</code> creates a matrix where the p-values of the test are below the diagonal and the number of matches of the test are above the diagonal.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Jones, K. E., Dickson, B. V., Angielczyk, K. D., &amp; Pierce, S. E. (2021). Adaptive landscapes challenge the "lateral-to-sagittal"" paradigm for mammalian vertebral evolution. Current Biology, 31(9), 1883-1892.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="calcGrpWprime.html">calcGrpWprime</a></code> and <code><a href="calcWprimeBy.html">calcWprimeBy</a></code> for creatign the objects used as inputs to these functions</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"warps"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"turtles"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">warps_fnc</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_fnc_df.html">as_fnc_df</a></span><span class="op">(</span><span class="va">warps</span>, </span></span>
<span class="r-in"><span>                       func.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hydro"</span>, <span class="st">"fea"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">kr_surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="krige_surf.html">krige_surf</a></span><span class="op">(</span><span class="va">warps_fnc</span>, new_data <span class="op">=</span> <span class="va">turtles</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">grid_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_weights.html">generate_weights</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, data <span class="op">=</span> <span class="va">kr_surf</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4 rows generated</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">all_lscps</span> <span class="op">&lt;-</span> <span class="fu"><a href="calc_all_lscps.html">calc_all_lscps</a></span><span class="op">(</span><span class="va">kr_surf</span>,</span></span>
<span class="r-in"><span>                            grid_weights <span class="op">=</span> <span class="va">grid_weights</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comparing adaptive landscapes of Ecology groups S and M</span></span></span>
<span class="r-in"><span><span class="va">wprime_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcGrpWprime.html">calcGrpWprime</a></span><span class="op">(</span><span class="va">all_lscps</span>,</span></span>
<span class="r-in"><span>                          index <span class="op">=</span> <span class="va">Ecology</span> <span class="op">==</span> <span class="st">"S"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wprime_M</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcGrpWprime.html">calcGrpWprime</a></span><span class="op">(</span><span class="va">all_lscps</span>,</span></span>
<span class="r-in"><span>                          index <span class="op">=</span> <span class="va">Ecology</span> <span class="op">==</span> <span class="st">"M"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">lands.grp.test</span><span class="op">(</span><span class="va">wprime_S</span>, <span class="va">wprime_M</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Landscape group test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - method: chi-squared | quantile: 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of matches: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-value: 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comparing adaptive landscapes of all Group subgroups</span></span></span>
<span class="r-in"><span><span class="va">wprime_by_Group</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcWprimeBy.html">calcWprimeBy</a></span><span class="op">(</span><span class="va">all_lscps</span>, by <span class="op">=</span> <span class="op">~</span><span class="va">Group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tests</span> <span class="op">&lt;-</span> <span class="fu">multi.lands.grp.test</span><span class="op">(</span><span class="va">wprime_by_Group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tests</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pairwise landscape group tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - method: chi-squared | quantile: 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            box turtle brackish fathead freshwater sea turtle softshell tortoise</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> box turtle -          1        2       1          1          1         2       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> brackish   0.25       -        1       1          0          1         0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fathead    0.5        1        -       1          0          1         0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> freshwater 0.25       1        0.5     -          0          1         0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sea turtle 0.25       0        0       0          -          0         1       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> softshell  0.25       1        0.5     1          0          -         0       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tortoise   0.5        0        0       0          1          0         -       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (lower triangle: p-values | upper triangle: number of matches)</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tests</span>, style <span class="op">=</span> <span class="st">"table"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pairwise landscape group tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - method: chi-squared | quantile: 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Group A    Group B Matches p value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  box turtle   brackish       1    0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  box turtle    fathead       2    0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  box turtle freshwater       1    0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  box turtle sea turtle       1    0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  box turtle  softshell       1    0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  box turtle   tortoise       2    0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    brackish    fathead       1    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    brackish freshwater       1    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    brackish sea turtle       0    0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   brackish  softshell       1    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   brackish   tortoise       0    0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    fathead freshwater       1    0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    fathead sea turtle       0    0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    fathead  softshell       1    0.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    fathead   tortoise       0    0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 freshwater sea turtle       0    0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 freshwater  softshell       1    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 freshwater   tortoise       0    0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 sea turtle  softshell       0    0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 sea turtle   tortoise       1    1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  softshell   tortoise       0    0.00</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Blake Dickson, Stephanie Pierce, Noah Greifer, Robert Brocklehurst.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

