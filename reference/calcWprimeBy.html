<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="calcWprimeBy() computes the optimally weighted adaptive landscape by searching through the adaptive landscapes formed from sets of weights and performance surfaces, and finding the set of weights that yields the greatest overall (average) fitness value (Z) across subsets of a sample dataset."><title>Compute optimally weighted adaptive landscapes by subgroup — calcWprimeBy • Morphoscape</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute optimally weighted adaptive landscapes by subgroup — calcWprimeBy"><meta property="og:description" content="calcWprimeBy() computes the optimally weighted adaptive landscape by searching through the adaptive landscapes formed from sets of weights and performance surfaces, and finding the set of weights that yields the greatest overall (average) fitness value (Z) across subsets of a sample dataset."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Morphoscape</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Morphoscape.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute optimally weighted adaptive landscapes by subgroup</h1>
      
      <div class="d-none name"><code>calcWprimeBy.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>calcWprimeBy()</code> computes the optimally weighted adaptive landscape by searching through the adaptive landscapes formed from sets of weights and performance surfaces, and finding the set of weights that yields the greatest overall (average) fitness value (Z) across subsets of a sample dataset.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">calcWprimeBy</span><span class="op">(</span><span class="va">x</span>, <span class="va">by</span>, method <span class="op">=</span> <span class="st">"chi-squared"</span>, quantile <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="co"># S3 method for by_Wprime</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, 
      digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for by_Wprime</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for summary.by_Wprime</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, 
      digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3L</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3L</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>for <code>calcWprimeBy()</code>, an <code>all_lscps</code> object; the output of a call to <code><a href="calc_all_lscps.html">calc_all_lscps</a></code>.</p>
<p>for <code>print.by_Wprime()</code>, a <code>by_Wprime</code> object; the output of a call to <code>calcWprimeBy()</code>.</p>
<p>for <code>print.summary.by_Wprime()</code>, a <code>by_Wprime</code> object; the output of a call to <code>summary.by_Wprime()</code>.</p></dd>

  <dt>by</dt>
<dd><p>a one-sided formula containing the grouping variable on the right hand side (e.g., <code>~g</code>) or a vector containing the subgrouping variable. When supplied as a formula, the grouping variable must be present in the global environment or in the <code>new_data</code> component in the <code>kriged_surfaces</code> object originally supplied to <code><a href="calc_all_lscps.html">calc_all_lscps()</a></code>.</p></dd>

  <dt>method</dt>
<dd><p>the method used to compute the optimal weights. Allowable options include <code>"chi-square"</code> (the default), <code>"quantile"</code>, or <code>"max"</code>. <code>"chi-square"</code> and <code>"quantile"</code> involve averaging across the best several sets of weights, whereas <code>"max"</code> uses the singular best set of weights. Abbreviations allowed. See <code><a href="calcGrpWprime.html">calcGrpWprime</a></code> for details.</p></dd>

  <dt>quantile</dt>
<dd><p>when <code>method</code> is <code>"chi-square"</code> or <code>"quantile"</code>, the top quantile used to determine the best sets of weights to be included in the average to compute the optimal set of weights. Should be a number between 0 and 1, with a low value indicating that only the few top sets of weights will be used. Ignored when <code>method = "max"</code>. See <code><a href="calcGrpWprime.html">calcGrpWprime</a></code> for details.</p></dd>

  <dt>digits</dt>
<dd><p>the number of significant digits to print.</p></dd>

  <dt>...</dt>
<dd><p>passed to <code><a href="https://rdrr.io/r/base/print.default.html" class="external-link">print.default</a></code> and <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print.table</a></code>.</p></dd>

  <dt>object</dt>
<dd><p>a <code>by_Wprime</code> object; the output of a call to <code>calcWprimeBy()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>calcWprimeBy()</code> splits the sample data based on the <code>by</code> variable and then calls <code><a href="calcGrpWprime.html">calcGrpWprime</a></code> on each subset. The main benefit of using <code>calcWprimeBy()</code> is that the subgrouping variable is part of the output object and therefore can be used in plotting using <code><a href="plot.wtd_lscp.html">plot.by_Wprime</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>by_Wprime</code> object contaning the following components:</p>
<dl><dt>by</dt>
<dd><p>the subgrouping variable supplied to <code>by</code>, stored as a factor and with a <code>"by_name"</code> attribute containing the name of the variable.</p></dd>

<dt>grp_Wprimes</dt>
<dd><p>a list of <code>grp_Wprime</code> objects, one for each level of the subgrouping variable.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="calc_all_lscps.html">calc_all_lscps</a></code> for computing the landscapes which are to be optimized.</p>
<p><code><a href="calcGrpWprime.html">calcGrpWprime</a></code> for finding optimal sets of weights for a single subgroup.</p>
<p><code><a href="plot.wtd_lscp.html">plot.by_Wprime</a></code> for plotting the resulting adaptive landscapes.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"warps"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"turtles"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">warps_fnc</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_fnc_df.html">as_fnc_df</a></span><span class="op">(</span><span class="va">warps</span>, </span>
<span class="r-in">                       func.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hydro"</span>, <span class="st">"fea"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">kr_surf</span> <span class="op">&lt;-</span> <span class="fu"><a href="krige_surf.html">krige_surf</a></span><span class="op">(</span><span class="va">warps_fnc</span>, new_data <span class="op">=</span> <span class="va">turtles</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">grid_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_weights.html">generate_weights</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, data <span class="op">=</span> <span class="va">kr_surf</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4 rows generated</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">all_lscps</span> <span class="op">&lt;-</span> <span class="fu"><a href="calc_all_lscps.html">calc_all_lscps</a></span><span class="op">(</span><span class="va">kr_surf</span>,</span>
<span class="r-in">                            grid_weights <span class="op">=</span> <span class="va">grid_weights</span><span class="op">)</span></span>
<span class="r-in">                            </span>
<span class="r-in"><span class="va">wprime_Ecology</span> <span class="op">&lt;-</span> <span class="fu">calcWprimeBy</span><span class="op">(</span><span class="va">all_lscps</span>, by <span class="op">=</span> <span class="op">~</span><span class="va">Ecology</span><span class="op">)</span></span>
<span class="r-in"><span class="va">wprime_Ecology</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Ecology == "M"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Weight SE SD Min. Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hydro      0 NA NA    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fea        1 NA NA    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average fitness value at optimal weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Value SE SD   Min.   Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z 0.7927 NA NA 0.7927 0.7927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Ecology == "S"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Weight SE SD Min. Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hydro      1 NA NA    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fea        0 NA NA    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average fitness value at optimal weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Value SE SD   Min.   Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z 0.7835 NA NA 0.7835 0.7835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Ecology == "T"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Weight     SE     SD Min. Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hydro    0.5 0.2152 0.4303    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fea      0.5 0.2152 0.4303    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average fitness value at optimal weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Value       SE       SD   Min.   Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z 0.218 0.001605 0.003211 0.2142 0.2217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - method: chi-squared, quantile = 0.05</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wprime_Ecology</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimal weights by Ecology:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   W_hydro  W_fea      Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M  0.0000 1.0000 0.7927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S  1.0000 0.0000 0.7835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> T  0.5000 0.5000 0.2180</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">wprime_Ecology</span><span class="op">)</span></span>
<span class="r-plt img"><img src="calcWprimeBy-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Blake Dickson, Stephanie Pierce, Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>

