[{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/articles/Morphoscape.html","id":"phenotype","dir":"Articles","previous_headings":"Defining a morphospace","what":"Phenotype","title":"Morphoscape","text":"Adaptive landscape analyses require two types data married together: phenotypic data performance data. Phenotype data can take many forms, requirement phenotype data construction adaptive landscapes definition morphospace. simplest type morphospace can 2D plot axes defined two numeric measurements phenotype, length width skull, though quantification phenotype valid. Geometric morphometrics become quintessential method quantifying detailed shape variation bony structures, final outcome many studies visualization PCA shape variation - morphospace. However, one defines morphospace can drastically impact outcomes adaptive landscape analyses. PCA -group PCA valid methods ordinate morphological data, yet produce dramatically different morphospaces depending goals analysis. PCA produce (largely) unbiased ordination major axes variation, bgPCA find axes variation maximize differences groups. Caution applied using constrained ordination like bgPCA, can create ecological patterns none may actually exist (see Bookstein 2019, Cardini et al 2019 Cardini & Polly 2020 cautionary debate). However, many ways bgPCA, constrained ordinations ideal questions regarding functional adaptive differences ecological groups actual morphological differences present. now adaptive landscape methods package limited 2D morphospaces, two axes phenotypic variation. largely done complexities involved analyzing visualizing multivariate covariance 3 dimensions. However, two axes phenotypic variation desired analyzed, can done separate analyses.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/articles/Morphoscape.html","id":"collecting-performance-data-specimens-or-warps","dir":"Articles","previous_headings":"Defining a morphospace","what":"Collecting performance data: Specimens or Warps","title":"Morphoscape","text":"ordination 2D morphospace phenotypic data defined, one must collect data performance phenotypes. two approaches one can take collecting performance data: collect data directly specimens, collect data phenotypic warps morphospace. former simplest direct long dataset large, allows know actual performance actual specimens. However, error can creep performance traits strongly covary axes morphospace, can produce uneven inconsistent surfaces. addition, specimens may evenly occupy morphospace resulting regions morphospace defined existing phenotypes, thus measured performance data may produce erroneous interpolations extrapolations performance. Finally, collecting performance data can time consuming, may impractical extremely large datasets. alternative collect performance data hypothetical warps across morphospace, eliminates issues. long method used define morphospace reversible (prcomp, geomorph::gm.prcomp, Morpho::prcompfast, Morpho::groupPCA, Morpho::CVA), possible extract phenotype location morphospace. fact many ordination functions come predict methods task. , using prediction, possible define phenotypes evenly across morphospace called warps. warps also useful can defined represent phenotypic variation axes morphospace, ignore variation axes. warps can however form biologically impossible phenotypes (walls bone crossing one another), may may help interpretations regions morphospace might occupied . approaches valid long morphospace reasonably well covered. -depth analysis morphospace sampling see Smith et al (2021). package comes turtle humerus dataset Dickson Pierce (2019), uses performance data collected warps. turtles dataset coordinate data 40 turtle humerus specimens ordinated bgPCA morphospace, first two axes maximizing differences three ecological groups: Marine, Freshwater Terrestrial turtles. dataset also includes ecological groupings. warps dataset 4x6 evenly spaced warps predicted morphospace 4 performance metrics.","code":"data(\"turtles\") data(\"warps\")  str(turtles) #> 'data.frame':    40 obs. of  4 variables: #>  $ x      : num  0.03486 -0.07419 -0.07846 0.00972 -0.00997 ... #>  $ y      : num  -0.019928 -0.015796 -0.010289 -0.000904 -0.029465 ... #>  $ Group  : chr  \"freshwater\" \"softshell\" \"softshell\" \"freshwater\" ... #>  $ Ecology: chr  \"S\" \"S\" \"S\" \"S\" ... str(warps) #> 'data.frame':    24 obs. of  6 variables: #>  $ x    : num  -0.189 -0.189 -0.189 -0.189 -0.134 ... #>  $ y    : num  -0.05161 -0.00363 0.04435 0.09233 -0.05161 ... #>  $ hydro: num  -1839 -1962 -2089 -2371 -1754 ... #>  $ curve: num  8.07 6.3 9.7 15.44 10.21 ... #>  $ mech : num  0.185 0.193 0.191 0.161 0.171 ... #>  $ fea  : num  -0.15516 -0.06215 -0.00435 0.14399 0.28171 ..."},{"path":"https://blakedickson.github.io/Morphoscape/articles/Morphoscape.html","id":"using-morphoscape","dir":"Articles","previous_headings":"","what":"Using Morphoscape","title":"Morphoscape","text":"morphospace defined performance data re collected, workflow using Morphoscape fairly straightforward. Using warp turtles datasets first step make functional dataframe using as_fnc_df(). input function dataframe containing coordinate data performance data (also grouping factors desired). first two columns must coordinates, columns can defined performance data, grouping factors. best performance data named point keep track.","code":"library(Morphoscape)  data(\"turtles\") data(\"warps\")  str(turtles) #> 'data.frame':    40 obs. of  4 variables: #>  $ x      : num  0.03486 -0.07419 -0.07846 0.00972 -0.00997 ... #>  $ y      : num  -0.019928 -0.015796 -0.010289 -0.000904 -0.029465 ... #>  $ Group  : chr  \"freshwater\" \"softshell\" \"softshell\" \"freshwater\" ... #>  $ Ecology: chr  \"S\" \"S\" \"S\" \"S\" ... str(warps) #> 'data.frame':    24 obs. of  6 variables: #>  $ x    : num  -0.189 -0.189 -0.189 -0.189 -0.134 ... #>  $ y    : num  -0.05161 -0.00363 0.04435 0.09233 -0.05161 ... #>  $ hydro: num  -1839 -1962 -2089 -2371 -1754 ... #>  $ curve: num  8.07 6.3 9.7 15.44 10.21 ... #>  $ mech : num  0.185 0.193 0.191 0.161 0.171 ... #>  $ fea  : num  -0.15516 -0.06215 -0.00435 0.14399 0.28171 ...  # Create an fnc_df object for downstream use warps_fnc <- as_fnc_df(warps, func.names = c(\"hydro\", \"curve\", \"mech\", \"fea\")) str(warps_fnc) #> Classes 'fnc_df' and 'data.frame':   24 obs. of  6 variables: #>  $ x    : num  -0.189 -0.189 -0.189 -0.189 -0.134 ... #>  $ y    : num  -0.05161 -0.00363 0.04435 0.09233 -0.05161 ... #>  $ hydro: num  0.763 0.627 0.487 0.174 0.858 ... #>  $ curve: num  0.0544 0 0.1045 0.281 0.1202 ... #>  $ mech : num  0.359 0.473 0.446 0 0.149 ... #>  $ fea  : num  0.372 0.458 0.512 0.65 0.777 ... #>  - attr(*, \"func.names\")= chr [1:4] \"hydro\" \"curve\" \"mech\" \"fea\""},{"path":"https://blakedickson.github.io/Morphoscape/articles/Morphoscape.html","id":"creating-performance-surfaces","dir":"Articles","previous_headings":"Using Morphoscape","what":"Creating Performance Surfaces","title":"Morphoscape","text":"simple process perform surface interpolation automatic Kriging using krige_surf() function. autofit kriging function data. performed automap::autoKrige() function. details fitting variograms read documentation automap. autoKrige fitting data kept kriged_surfaces object along output surface. default krige_surf() function interpolate within alpha hull wrapped around inputted datapoints. avoid extrapolation beyond measured datapoints. can defined using resample_grid() function, supply grid object defining points interpolate, optionally plot area reconstructed. strength wrapping can controlled using alpha argument, smaller values producing stronger wrapping.   However, one wishes also extrapolate full extent morphospace, set hull = FALSE. warps dataset evenly samples morphospace, can set hull = FALSE reconstruct full rectangle morphospace. hull = FALSE amount padding also applied provide space beyond supplied datapoints can controlled using padding argument. Finally, can also specify density interpolated points using resample argument.  reconstructed surface missing actual specimen data points associated ecological groupings, needed later analyses. can added using krige_new_data() function.  course can done one step. krige_surf automatically call resample_grid() grid argument supplied, new_data can supplied data later group optimums calculated .","code":"# Create alpha-hulled grid for kriging grid <- resample_grid(warps, hull = TRUE, alpha = 3, plot = TRUE) kr_surf <- krige_surf(warps_fnc, grid = grid) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] kr_surf #> A kriged_surfaces object #> - functional characteristics: #>  hydro, curve, mech, fea #> - surface size: #>  70 by 70 #>  α-hull applied (α = 3) #> - original data: #>  24 rows plot(kr_surf) # Create alpha-hulled grid for kriging grid <- resample_grid(warps, hull = FALSE, padding = 1.1)  # Do the kriging on the grid kr_surf <- krige_surf(warps_fnc, grid = grid) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] kr_surf #> A kriged_surfaces object #> - functional characteristics: #>  hydro, curve, mech, fea #> - surface size: #>  100 by 100 #> - original data: #>  24 rows plot(kr_surf) # Do kriging on the sample dataset kr_surf <- krige_new_data(kr_surf, new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] kr_surf #> A kriged_surfaces object #> - functional characteristics: #>  hydro, curve, mech, fea #> - surface size: #>  100 by 100 #> - original data: #>  24 rows #> - new data: #>  40 rows plot(kr_surf) # Above steps all in one: kr_surf <- krige_surf(warps_fnc, hull = FALSE, padding = 1.1,                       new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] kr_surf #> A kriged_surfaces object #> - functional characteristics: #>  hydro, curve, mech, fea #> - surface size: #>  100 by 100 #> - original data: #>  24 rows #> - new data: #>  40 rows plot(kr_surf)"},{"path":"https://blakedickson.github.io/Morphoscape/articles/Morphoscape.html","id":"calculate-landscapes","dir":"Articles","previous_headings":"Using Morphoscape","what":"Calculate Landscapes","title":"Morphoscape","text":"next step calculate distribution adaptive landscapes. adaptive landscape constructed summation performance surfaces differing magnitudes, performance surface multiplied weight ranging 0-1, total sum weights equal 1. four equally weighted performance surfaces, weights vector c(0.25, 0.25, 0.25, 0.25). generate distribution different combinations weights, use generate_weights() function. generate_weights must either step n argument determine many allocations generate, nvar number variables. One can also provide either fnc_df kr_surf objects data argument. step determines step size weight values. step = 0.1 generate vectors c(0, 0.1, 0.2 ... 1). Alternatively, one can set number values sequence set. n = 10 generate vectors c(0, 0.1, 0.2 ... 1). function generate combinations nvar variables sum 1. four variables, produce 286 combinations. step size 0.05 produce 1771 rows. step size gets smaller, number variables increases, number output rows exponentially increase. recommended start large step sizes, small n ensure things working correctly. weights matrix provided calc_all_landscapes() along kr_surf object calculate landscapes set weights. calculations large number weights, outputs can take time can large size, recommended utilize file argument save output file. distribution landscapes, now possible find landscapes maximize ‘fitness’ given subset group specimens new_data using calcWprimeBy() function. argument sets grouping variable data provided new_data earlier. several ways can set: one sided formula containing name column new_data vector containing factor variable.  also possible use calcGrpWprime enumerate single group entire sample:  Finally, possible compare landscapes group using calcGrpWprime(). done comparing number landscape combinations shared upper percentile groups.","code":"# Generate weights to search for optimal landscapes weights <- generate_weights(n = 10, nvar = 4) #> 286 rows generated weights <- generate_weights(step = 0.05 , data = kr_surf) #> 1771 rows generated # Calculate all landscapes; setting verbose = TRUE produces # a progress bar all_landscapes <- calc_all_lscps(kr_surf, grid_weights = weights) # Calculate optimal landscapes by Group  table(turtles$Ecology) #>  #>  M  S  T  #>  4 29  7  wprime_by_Group <- calcWprimeBy(all_landscapes, by = ~Ecology) wprime_by_Group <- calcWprimeBy(all_landscapes, by = turtles$Ecology)  wprime_by_Group #> - turtles$Ecology == \"M\" #>  #> Optimal weights: #>         Weight       SE      SD Min. Max. #> hydro 0.104167 0.029167 0.10104  0.0 0.30 #> curve 0.008333 0.005618 0.01946  0.0 0.05 #> mech  0.012500 0.006528 0.02261  0.0 0.05 #> fea   0.875000 0.025746 0.08919  0.7 1.00 #>  #> Average fitness value at optimal weights: #>    Value       SE      SD   Min.   Max. #> Z 0.7612 0.004671 0.01618 0.7437 0.7927 #> ----------------------------------------- #> - turtles$Ecology == \"S\" #>  #> Optimal weights: #>        Weight       SE      SD Min. Max. #> hydro 0.85469 0.009878 0.05588  0.8 1.00 #> curve 0.05312 0.010025 0.05671  0.0 0.20 #> mech  0.05312 0.010025 0.05671  0.0 0.20 #> fea   0.03906 0.007691 0.04350  0.0 0.15 #>  #> Average fitness value at optimal weights: #>    Value       SE      SD   Min.   Max. #> Z 0.7491 0.002325 0.01315 0.7326 0.7835 #> ----------------------------------------- #> - turtles$Ecology == \"T\" #>  #> Optimal weights: #>       Weight      SE      SD Min. Max. #> hydro 0.0125 0.00559 0.02236 0.00 0.05 #> curve 0.8500 0.02415 0.09661 0.65 1.00 #> mech  0.1250 0.02661 0.10646 0.00 0.35 #> fea   0.0125 0.00559 0.02236 0.00 0.05 #>  #> Average fitness value at optimal weights: #>    Value       SE      SD  Min.   Max. #> Z 0.7538 0.003712 0.01485 0.736 0.7852 #>  #> - method: chi-squared, quantile = 0.05 summary(wprime_by_Group) #> Optimal weights by turtles$Ecology: #>    W_hydro  W_curve   W_mech    W_fea        Z #> M 0.104167 0.008333 0.012500 0.875000 0.761245 #> S 0.854688 0.053125 0.053125 0.039062 0.749055 #> T 0.012500 0.850000 0.125000 0.012500 0.753825 plot(wprime_by_Group, ncol = 2) # Calculate landscapes for one Group at a time  i <- which(turtles$Ecology == \"T\") wprime_T <- calcGrpWprime(all_landscapes, index = i) wprime_T #> Optimal weights: #>       Weight      SE      SD Min. Max. #> hydro 0.0125 0.00559 0.02236 0.00 0.05 #> curve 0.8500 0.02415 0.09661 0.65 1.00 #> mech  0.1250 0.02661 0.10646 0.00 0.35 #> fea   0.0125 0.00559 0.02236 0.00 0.05 #>  #> Average fitness value at optimal weights: #>    Value       SE      SD  Min.   Max. #> Z 0.7538 0.003712 0.01485 0.736 0.7852 #>  #> - method: chi-squared, quantile = 0.05 wprime_b <- calcGrpWprime(all_landscapes, Group == \"box turtle\") wprime_b #> Optimal weights: #>        Weight       SE      SD Min. Max. #> hydro 0.01944 0.007162 0.03038  0.0  0.1 #> curve 0.86944 0.018140 0.07696  0.7  1.0 #> mech  0.09167 0.021862 0.09275  0.0  0.3 #> fea   0.01944 0.007162 0.03038  0.0  0.1 #>  #> Average fitness value at optimal weights: #>    Value       SE      SD   Min.   Max. #> Z 0.7746 0.003492 0.01482 0.7565 0.8073 #>  #> - method: chi-squared, quantile = 0.05 plot(wprime_b) wprime_all <- calcGrpWprime(all_landscapes) wprime_all #> Optimal weights: #>        Weight       SE      SD Min. Max. #> hydro 0.74853 0.008797 0.08885  0.6 1.00 #> curve 0.10735 0.009984 0.10084  0.0 0.40 #> mech  0.08578 0.008342 0.08425  0.0 0.35 #> fea   0.05833 0.006156 0.06217  0.0 0.25 #>  #> Average fitness value at optimal weights: #>    Value       SE      SD   Min. Max. #> Z 0.6343 0.001179 0.01191 0.6193 0.67 #>  #> - method: chi-squared, quantile = 0.05 # Test for differences between Group landscapes tests <- multi.lands.grp.test(wprime_by_Group) tests #> Pairwise landscape group tests #> - method: chi-squared | quantile: 0.05 #>  #> Results: #>   M S T #> M - 0 0 #> S 0 - 0 #> T 0 0 - #> (lower triangle: p-values | upper triangle: number of matches)  # Calculate landscapes for one Group at a time wprime_b <- calcGrpWprime(all_landscapes, Group == \"box turtle\") wprime_b #> Optimal weights: #>        Weight       SE      SD Min. Max. #> hydro 0.01944 0.007162 0.03038  0.0  0.1 #> curve 0.86944 0.018140 0.07696  0.7  1.0 #> mech  0.09167 0.021862 0.09275  0.0  0.3 #> fea   0.01944 0.007162 0.03038  0.0  0.1 #>  #> Average fitness value at optimal weights: #>    Value       SE      SD   Min.   Max. #> Z 0.7746 0.003492 0.01482 0.7565 0.8073 #>  #> - method: chi-squared, quantile = 0.05 wprime_t <- calcGrpWprime(all_landscapes, Group == \"tortoise\") wprime_t #> Optimal weights: #>        Weight       SE      SD Min. Max. #> hydro 0.01176 0.005302 0.02186 0.00 0.05 #> curve 0.85294 0.022877 0.09432 0.65 1.00 #> mech  0.11765 0.026059 0.10744 0.00 0.35 #> fea   0.01765 0.007353 0.03032 0.00 0.10 #>  #> Average fitness value at optimal weights: #>    Value       SE      SD   Min.   Max. #> Z 0.7008 0.003571 0.01472 0.6829 0.7325 #>  #> - method: chi-squared, quantile = 0.05  # Test for differences between Group landscapes lands.grp.test(wprime_b, wprime_t) #> Landscape group test #> - method: chi-squared | quantile: 0.05 #>  #> Number of matches: 16 #> P-value: 0.8889"},{"path":"https://blakedickson.github.io/Morphoscape/articles/Morphoscape.html","id":"references","dir":"Articles","previous_headings":"Using Morphoscape","what":"References","title":"Morphoscape","text":"Bookstein, F. L. (2019). Pathologies -groups principal components analysis geometric morphometrics. Evolutionary Biology, 46(4), 271-302. Cardini, ., O’Higgins, P., & Rohlf, F. J. (2019). Seeing distinct groups none: spurious patterns -group PCA. Evolutionary Biology, 46(4), 303-316. Cardini, ., & Polly, P. D. (2020). Cross-validated group PCA scatterplots: solution spurious group separation?. Evolutionary Biology, 47(1), 85-95. Dickson, B. V., & Pierce, S. E. (2019). Functional performance turtle humerus shape across ecological adaptive landscape. Evolution, 73(6), 1265-1277. Smith, S. M., Stayton, C. T., & Angielczyk, K. D. (2021). many trees see forest? Assessing effects morphospace coverage sample size performance surface analysis. Methods Ecology Evolution, 12(8), 1411-1424.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Blake Dickson. Author, maintainer. Stephanie Pierce. Author. Noah Greifer. Author.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Dickson B, Pierce S, Greifer N (2022). Morphoscape: Computation Visualization Adaptive Landscapes. R package version 1.0.0, https://blakedickson.github.io/Morphoscape/.","code":"@Manual{,   title = {Morphoscape: Computation and Visualization of Adaptive Landscapes},   author = {Blake Dickson and Stephanie Pierce and Noah Greifer},   year = {2022},   note = {R package version 1.0.0},   url = {https://blakedickson.github.io/Morphoscape/}, }"},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/index.html","id":"section","dir":"","previous_headings":"","what":"Computation and Visualization of Adaptive Landscapes","title":"Computation and Visualization of Adaptive Landscapes","text":"Morphoscape package designed constructions, analysis visualization spatially organized trait data adaptive landscapes. Morphoscape provides pipeline combining spatial coordinate data derived ordinated morphospace, PCA, performance trait data; finding ‘optimum’ adaptive landscapes combination trait data. Morphoscape provide tools generation morphospaces. shape analyses tools ordinate multivariate phenotypic data, see Geomorph Morpho packages. -depth guide using Morphoscape, discussion morphospace design, see vignette. install Morphoscape GitHub need install devtools package run install_github(\"blakedickson/Morphoscape\"): point entry Morphoscape dataframe containing two columns XY coordinate data followed columns containing performance variables. See warps data object example. additional dataframe turtles specimen coordinates grouping variables also provided. dataframe input as_fnc_df() coerce coordinate data correct format, rescale performance variables unit range. Performance surfaces calculated using krige_surf(), can used just calculate surfaces, also predict performance new_data points.  calculate adaptive landscapes based groupings, first population landscapes generated using generate_weights() calc_all_lscps(): Optimal landscapes groups calculated using calcWprimeBy() can statistically compared using multi.lands.grp.test():  cite Morphoscape, please run citation(\"Morphoscape\").","code":"install.packages(\"devtools\") devtools::install_github(\"blakedickson/Morphoscape\") library(Morphoscape) data('warps') str(warps) #> 'data.frame':    24 obs. of  6 variables: #>  $ x    : num  -0.189 -0.189 -0.189 -0.189 -0.134 ... #>  $ y    : num  -0.05161 -0.00363 0.04435 0.09233 -0.05161 ... #>  $ hydro: num  -1839 -1962 -2089 -2371 -1754 ... #>  $ curve: num  8.07 6.3 9.7 15.44 10.21 ... #>  $ mech : num  0.185 0.193 0.191 0.161 0.171 ... #>  $ fea  : num  -0.15516 -0.06215 -0.00435 0.14399 0.28171 ... data('turtles') str(turtles) #> 'data.frame':    40 obs. of  4 variables: #>  $ x      : num  0.03486 -0.07419 -0.07846 0.00972 -0.00997 ... #>  $ y      : num  -0.019928 -0.015796 -0.010289 -0.000904 -0.029465 ... #>  $ Group  : chr  \"freshwater\" \"softshell\" \"softshell\" \"freshwater\" ... #>  $ Ecology: chr  \"S\" \"S\" \"S\" \"S\" ... warps_fnc <- as_fnc_df(warps, func.names = c(\"hydro\", \"curve\", \"mech\", \"fea\")) kr_surf <- krige_surf(warps_fnc, hull = FALSE, new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] plot(kr_surf) weights <- generate_weights(n = 10, data = kr_surf) all_landscapes <- calc_all_lscps(kr_surf, grid_weights = weights) #> Calculating landscapes... #>   |                                                                                                                                                                                                      |                                                                                                                                                                                              |   0%  |                                                                                                                                                                                                      |=                                                                                                                                                                                             |   0%  |                                                                                                                                                                                                      |=                                                                                                                                                                                             |   1%  |                                                                                                                                                                                                      |==                                                                                                                                                                                            |   1%  |                                                                                                                                                                                                      |===                                                                                                                                                                                           |   1%  |                                                                                                                                                                                                      |===                                                                                                                                                                                           |   2%  |                                                                                                                                                                                                      |====                                                                                                                                                                                          |   2%  |                                                                                                                                                                                                      |=====                                                                                                                                                                                         |   2%  |                                                                                                                                                                                                      |=====                                                                                                                                                                                         |   3%  |                                                                                                                                                                                                      |======                                                                                                                                                                                        |   3%  |                                                                                                                                                                                                      |=======                                                                                                                                                                                       |   3%  |                                                                                                                                                                                                      |=======                                                                                                                                                                                       |   4%  |                                                                                                                                                                                                      |========                                                                                                                                                                                      |   4%  |                                                                                                                                                                                                      |=========                                                                                                                                                                                     |   5%  |                                                                                                                                                                                                      |==========                                                                                                                                                                                    |   5%  |                                                                                                                                                                                                      |===========                                                                                                                                                                                   |   6%  |                                                                                                                                                                                                      |============                                                                                                                                                                                  |   6%  |                                                                                                                                                                                                      |=============                                                                                                                                                                                 |   7%  |                                                                                                                                                                                                      |==============                                                                                                                                                                                |   7%  |                                                                                                                                                                                                      |===============                                                                                                                                                                               |   8%  |                                                                                                                                                                                                      |================                                                                                                                                                                              |   8%  |                                                                                                                                                                                                      |=================                                                                                                                                                                             |   9%  |                                                                                                                                                                                                      |==================                                                                                                                                                                            |   9%  |                                                                                                                                                                                                      |===================                                                                                                                                                                           |  10%  |                                                                                                                                                                                                      |====================                                                                                                                                                                          |  10%  |                                                                                                                                                                                                      |=====================                                                                                                                                                                         |  11%  |                                                                                                                                                                                                      |======================                                                                                                                                                                        |  12%  |                                                                                                                                                                                                      |=======================                                                                                                                                                                       |  12%  |                                                                                                                                                                                                      |========================                                                                                                                                                                      |  13%  |                                                                                                                                                                                                      |=========================                                                                                                                                                                     |  13%  |                                                                                                                                                                                                      |==========================                                                                                                                                                                    |  14%  |                                                                                                                                                                                                      |===========================                                                                                                                                                                   |  14%  |                                                                                                                                                                                                      |============================                                                                                                                                                                  |  15%  |                                                                                                                                                                                                      |=============================                                                                                                                                                                 |  15%  |                                                                                                                                                                                                      |==============================                                                                                                                                                                |  16%  |                                                                                                                                                                                                      |===============================                                                                                                                                                               |  16%  |                                                                                                                                                                                                      |================================                                                                                                                                                              |  17%  |                                                                                                                                                                                                      |=================================                                                                                                                                                             |  17%  |                                                                                                                                                                                                      |==================================                                                                                                                                                            |  18%  |                                                                                                                                                                                                      |===================================                                                                                                                                                           |  18%  |                                                                                                                                                                                                      |===================================                                                                                                                                                           |  19%  |                                                                                                                                                                                                      |====================================                                                                                                                                                          |  19%  |                                                                                                                                                                                                      |=====================================                                                                                                                                                         |  19%  |                                                                                                                                                                                                      |=====================================                                                                                                                                                         |  20%  |                                                                                                                                                                                                      |======================================                                                                                                                                                        |  20%  |                                                                                                                                                                                                      |=======================================                                                                                                                                                       |  20%  |                                                                                                                                                                                                      |=======================================                                                                                                                                                       |  21%  |                                                                                                                                                                                                      |========================================                                                                                                                                                      |  21%  |                                                                                                                                                                                                      |=========================================                                                                                                                                                     |  21%  |                                                                                                                                                                                                      |=========================================                                                                                                                                                     |  22%  |                                                                                                                                                                                                      |==========================================                                                                                                                                                    |  22%  |                                                                                                                                                                                                      |===========================================                                                                                                                                                   |  22%  |                                                                                                                                                                                                      |===========================================                                                                                                                                                   |  23%  |                                                                                                                                                                                                      |============================================                                                                                                                                                  |  23%  |                                                                                                                                                                                                      |=============================================                                                                                                                                                 |  23%  |                                                                                                                                                                                                      |=============================================                                                                                                                                                 |  24%  |                                                                                                                                                                                                      |==============================================                                                                                                                                                |  24%  |                                                                                                                                                                                                      |===============================================                                                                                                                                               |  24%  |                                                                                                                                                                                                      |===============================================                                                                                                                                               |  25%  |                                                                                                                                                                                                      |================================================                                                                                                                                              |  25%  |                                                                                                                                                                                                      |================================================                                                                                                                                              |  26%  |                                                                                                                                                                                                      |=================================================                                                                                                                                             |  26%  |                                                                                                                                                                                                      |==================================================                                                                                                                                            |  26%  |                                                                                                                                                                                                      |==================================================                                                                                                                                            |  27%  |                                                                                                                                                                                                      |===================================================                                                                                                                                           |  27%  |                                                                                                                                                                                                      |====================================================                                                                                                                                          |  27%  |                                                                                                                                                                                                      |====================================================                                                                                                                                          |  28%  |                                                                                                                                                                                                      |=====================================================                                                                                                                                         |  28%  |                                                                                                                                                                                                      |======================================================                                                                                                                                        |  28%  |                                                                                                                                                                                                      |======================================================                                                                                                                                        |  29%  |                                                                                                                                                                                                      |=======================================================                                                                                                                                       |  29%  |                                                                                                                                                                                                      |========================================================                                                                                                                                      |  29%  |                                                                                                                                                                                                      |========================================================                                                                                                                                      |  30%  |                                                                                                                                                                                                      |=========================================================                                                                                                                                     |  30%  |                                                                                                                                                                                                      |==========================================================                                                                                                                                    |  30%  |                                                                                                                                                                                                      |==========================================================                                                                                                                                    |  31%  |                                                                                                                                                                                                      |===========================================================                                                                                                                                   |  31%  |                                                                                                                                                                                                      |============================================================                                                                                                                                  |  31%  |                                                                                                                                                                                                      |============================================================                                                                                                                                  |  32%  |                                                                                                                                                                                                      |=============================================================                                                                                                                                 |  32%  |                                                                                                                                                                                                      |==============================================================                                                                                                                                |  33%  |                                                                                                                                                                                                      |===============================================================                                                                                                                               |  33%  |                                                                                                                                                                                                      |================================================================                                                                                                                              |  34%  |                                                                                                                                                                                                      |=================================================================                                                                                                                             |  34%  |                                                                                                                                                                                                      |==================================================================                                                                                                                            |  35%  |                                                                                                                                                                                                      |===================================================================                                                                                                                           |  35%  |                                                                                                                                                                                                      |====================================================================                                                                                                                          |  36%  |                                                                                                                                                                                                      |=====================================================================                                                                                                                         |  36%  |                                                                                                                                                                                                      |======================================================================                                                                                                                        |  37%  |                                                                                                                                                                                                      |=======================================================================                                                                                                                       |  37%  |                                                                                                                                                                                                      |========================================================================                                                                                                                      |  38%  |                                                                                                                                                                                                      |=========================================================================                                                                                                                     |  38%  |                                                                                                                                                                                                      |==========================================================================                                                                                                                    |  39%  |                                                                                                                                                                                                      |===========================================================================                                                                                                                   |  40%  |                                                                                                                                                                                                      |============================================================================                                                                                                                  |  40%  |                                                                                                                                                                                                      |=============================================================================                                                                                                                 |  41%  |                                                                                                                                                                                                      |==============================================================================                                                                                                                |  41%  |                                                                                                                                                                                                      |===============================================================================                                                                                                               |  42%  |                                                                                                                                                                                                      |================================================================================                                                                                                              |  42%  |                                                                                                                                                                                                      |=================================================================================                                                                                                             |  43%  |                                                                                                                                                                                                      |==================================================================================                                                                                                            |  43%  |                                                                                                                                                                                                      |===================================================================================                                                                                                           |  44%  |                                                                                                                                                                                                      |====================================================================================                                                                                                          |  44%  |                                                                                                                                                                                                      |=====================================================================================                                                                                                         |  45%  |                                                                                                                                                                                                      |======================================================================================                                                                                                        |  45%  |                                                                                                                                                                                                      |=======================================================================================                                                                                                       |  46%  |                                                                                                                                                                                                      |========================================================================================                                                                                                      |  46%  |                                                                                                                                                                                                      |========================================================================================                                                                                                      |  47%  |                                                                                                                                                                                                      |=========================================================================================                                                                                                     |  47%  |                                                                                                                                                                                                      |==========================================================================================                                                                                                    |  47%  |                                                                                                                                                                                                      |==========================================================================================                                                                                                    |  48%  |                                                                                                                                                                                                      |===========================================================================================                                                                                                   |  48%  |                                                                                                                                                                                                      |============================================================================================                                                                                                  |  48%  |                                                                                                                                                                                                      |============================================================================================                                                                                                  |  49%  |                                                                                                                                                                                                      |=============================================================================================                                                                                                 |  49%  |                                                                                                                                                                                                      |==============================================================================================                                                                                                |  49%  |                                                                                                                                                                                                      |==============================================================================================                                                                                                |  50%  |                                                                                                                                                                                                      |===============================================================================================                                                                                               |  50%  |                                                                                                                                                                                                      |================================================================================================                                                                                              |  50%  |                                                                                                                                                                                                      |================================================================================================                                                                                              |  51%  |                                                                                                                                                                                                      |=================================================================================================                                                                                             |  51%  |                                                                                                                                                                                                      |==================================================================================================                                                                                            |  51%  |                                                                                                                                                                                                      |==================================================================================================                                                                                            |  52%  |                                                                                                                                                                                                      |===================================================================================================                                                                                           |  52%  |                                                                                                                                                                                                      |====================================================================================================                                                                                          |  52%  |                                                                                                                                                                                                      |====================================================================================================                                                                                          |  53%  |                                                                                                                                                                                                      |=====================================================================================================                                                                                         |  53%  |                                                                                                                                                                                                      |======================================================================================================                                                                                        |  53%  |                                                                                                                                                                                                      |======================================================================================================                                                                                        |  54%  |                                                                                                                                                                                                      |=======================================================================================================                                                                                       |  54%  |                                                                                                                                                                                                      |========================================================================================================                                                                                      |  55%  |                                                                                                                                                                                                      |=========================================================================================================                                                                                     |  55%  |                                                                                                                                                                                                      |==========================================================================================================                                                                                    |  56%  |                                                                                                                                                                                                      |===========================================================================================================                                                                                   |  56%  |                                                                                                                                                                                                      |============================================================================================================                                                                                  |  57%  |                                                                                                                                                                                                      |=============================================================================================================                                                                                 |  57%  |                                                                                                                                                                                                      |==============================================================================================================                                                                                |  58%  |                                                                                                                                                                                                      |===============================================================================================================                                                                               |  58%  |                                                                                                                                                                                                      |================================================================================================================                                                                              |  59%  |                                                                                                                                                                                                      |=================================================================================================================                                                                             |  59%  |                                                                                                                                                                                                      |==================================================================================================================                                                                            |  60%  |                                                                                                                                                                                                      |===================================================================================================================                                                                           |  60%  |                                                                                                                                                                                                      |====================================================================================================================                                                                          |  61%  |                                                                                                                                                                                                      |=====================================================================================================================                                                                         |  62%  |                                                                                                                                                                                                      |======================================================================================================================                                                                        |  62%  |                                                                                                                                                                                                      |=======================================================================================================================                                                                       |  63%  |                                                                                                                                                                                                      |========================================================================================================================                                                                      |  63%  |                                                                                                                                                                                                      |=========================================================================================================================                                                                     |  64%  |                                                                                                                                                                                                      |==========================================================================================================================                                                                    |  64%  |                                                                                                                                                                                                      |===========================================================================================================================                                                                   |  65%  |                                                                                                                                                                                                      |============================================================================================================================                                                                  |  65%  |                                                                                                                                                                                                      |=============================================================================================================================                                                                 |  66%  |                                                                                                                                                                                                      |==============================================================================================================================                                                                |  66%  |                                                                                                                                                                                                      |===============================================================================================================================                                                               |  67%  |                                                                                                                                                                                                      |================================================================================================================================                                                              |  67%  |                                                                                                                                                                                                      |=================================================================================================================================                                                             |  68%  |                                                                                                                                                                                                      |==================================================================================================================================                                                            |  68%  |                                                                                                                                                                                                      |==================================================================================================================================                                                            |  69%  |                                                                                                                                                                                                      |===================================================================================================================================                                                           |  69%  |                                                                                                                                                                                                      |====================================================================================================================================                                                          |  69%  |                                                                                                                                                                                                      |====================================================================================================================================                                                          |  70%  |                                                                                                                                                                                                      |=====================================================================================================================================                                                         |  70%  |                                                                                                                                                                                                      |======================================================================================================================================                                                        |  70%  |                                                                                                                                                                                                      |======================================================================================================================================                                                        |  71%  |                                                                                                                                                                                                      |=======================================================================================================================================                                                       |  71%  |                                                                                                                                                                                                      |========================================================================================================================================                                                      |  71%  |                                                                                                                                                                                                      |========================================================================================================================================                                                      |  72%  |                                                                                                                                                                                                      |=========================================================================================================================================                                                     |  72%  |                                                                                                                                                                                                      |==========================================================================================================================================                                                    |  72%  |                                                                                                                                                                                                      |==========================================================================================================================================                                                    |  73%  |                                                                                                                                                                                                      |===========================================================================================================================================                                                   |  73%  |                                                                                                                                                                                                      |============================================================================================================================================                                                  |  73%  |                                                                                                                                                                                                      |============================================================================================================================================                                                  |  74%  |                                                                                                                                                                                                      |=============================================================================================================================================                                                 |  74%  |                                                                                                                                                                                                      |==============================================================================================================================================                                                |  74%  |                                                                                                                                                                                                      |==============================================================================================================================================                                                |  75%  |                                                                                                                                                                                                      |===============================================================================================================================================                                               |  75%  |                                                                                                                                                                                                      |===============================================================================================================================================                                               |  76%  |                                                                                                                                                                                                      |================================================================================================================================================                                              |  76%  |                                                                                                                                                                                                      |=================================================================================================================================================                                             |  76%  |                                                                                                                                                                                                      |=================================================================================================================================================                                             |  77%  |                                                                                                                                                                                                      |==================================================================================================================================================                                            |  77%  |                                                                                                                                                                                                      |===================================================================================================================================================                                           |  77%  |                                                                                                                                                                                                      |===================================================================================================================================================                                           |  78%  |                                                                                                                                                                                                      |====================================================================================================================================================                                          |  78%  |                                                                                                                                                                                                      |=====================================================================================================================================================                                         |  78%  |                                                                                                                                                                                                      |=====================================================================================================================================================                                         |  79%  |                                                                                                                                                                                                      |======================================================================================================================================================                                        |  79%  |                                                                                                                                                                                                      |=======================================================================================================================================================                                       |  79%  |                                                                                                                                                                                                      |=======================================================================================================================================================                                       |  80%  |                                                                                                                                                                                                      |========================================================================================================================================================                                      |  80%  |                                                                                                                                                                                                      |=========================================================================================================================================================                                     |  80%  |                                                                                                                                                                                                      |=========================================================================================================================================================                                     |  81%  |                                                                                                                                                                                                      |==========================================================================================================================================================                                    |  81%  |                                                                                                                                                                                                      |===========================================================================================================================================================                                   |  81%  |                                                                                                                                                                                                      |===========================================================================================================================================================                                   |  82%  |                                                                                                                                                                                                      |============================================================================================================================================================                                  |  82%  |                                                                                                                                                                                                      |=============================================================================================================================================================                                 |  83%  |                                                                                                                                                                                                      |==============================================================================================================================================================                                |  83%  |                                                                                                                                                                                                      |===============================================================================================================================================================                               |  84%  |                                                                                                                                                                                                      |================================================================================================================================================================                              |  84%  |                                                                                                                                                                                                      |=================================================================================================================================================================                             |  85%  |                                                                                                                                                                                                      |==================================================================================================================================================================                            |  85%  |                                                                                                                                                                                                      |===================================================================================================================================================================                           |  86%  |                                                                                                                                                                                                      |====================================================================================================================================================================                          |  86%  |                                                                                                                                                                                                      |=====================================================================================================================================================================                         |  87%  |                                                                                                                                                                                                      |======================================================================================================================================================================                        |  87%  |                                                                                                                                                                                                      |=======================================================================================================================================================================                       |  88%  |                                                                                                                                                                                                      |========================================================================================================================================================================                      |  88%  |                                                                                                                                                                                                      |=========================================================================================================================================================================                     |  89%  |                                                                                                                                                                                                      |==========================================================================================================================================================================                    |  90%  |                                                                                                                                                                                                      |===========================================================================================================================================================================                   |  90%  |                                                                                                                                                                                                      |============================================================================================================================================================================                  |  91%  |                                                                                                                                                                                                      |=============================================================================================================================================================================                 |  91%  |                                                                                                                                                                                                      |==============================================================================================================================================================================                |  92%  |                                                                                                                                                                                                      |===============================================================================================================================================================================               |  92%  |                                                                                                                                                                                                      |================================================================================================================================================================================              |  93%  |                                                                                                                                                                                                      |=================================================================================================================================================================================             |  93%  |                                                                                                                                                                                                      |==================================================================================================================================================================================            |  94%  |                                                                                                                                                                                                      |===================================================================================================================================================================================           |  94%  |                                                                                                                                                                                                      |====================================================================================================================================================================================          |  95%  |                                                                                                                                                                                                      |=====================================================================================================================================================================================         |  95%  |                                                                                                                                                                                                      |======================================================================================================================================================================================        |  96%  |                                                                                                                                                                                                      |=======================================================================================================================================================================================       |  96%  |                                                                                                                                                                                                      |=======================================================================================================================================================================================       |  97%  |                                                                                                                                                                                                      |========================================================================================================================================================================================      |  97%  |                                                                                                                                                                                                      |=========================================================================================================================================================================================     |  97%  |                                                                                                                                                                                                      |=========================================================================================================================================================================================     |  98%  |                                                                                                                                                                                                      |==========================================================================================================================================================================================    |  98%  |                                                                                                                                                                                                      |===========================================================================================================================================================================================   |  98%  |                                                                                                                                                                                                      |===========================================================================================================================================================================================   |  99%  |                                                                                                                                                                                                      |============================================================================================================================================================================================  |  99%  |                                                                                                                                                                                                      |============================================================================================================================================================================================= |  99%  |                                                                                                                                                                                                      |============================================================================================================================================================================================= | 100%  |                                                                                                                                                                                                      |==============================================================================================================================================================================================| 100% all_landscapes #> An all_lscps object #> - functional characteristics: #>  hydro, curve, mech, fea #> - number of landscapes: #>  286 #> - weights incremented by: #>  0.1 #> - new data: #>  40 rows wprime_by_Group <- calcWprimeBy(all_landscapes, by = ~Ecology)  wprime_by_Group #> - Ecology == \"M\" #>  #> Optimal weights: #>       Weight      SE     SD Min. Max. #> hydro   0.15 0.06455 0.1291  0.0  0.3 #> curve   0.00 0.00000 0.0000  0.0  0.0 #> mech    0.00 0.00000 0.0000  0.0  0.0 #> fea     0.85 0.06455 0.1291  0.7  1.0 #>  #> Average fitness value at optimal weights: #>    Value      SE      SD   Min.   Max. #> Z 0.7686 0.01039 0.02078 0.7444 0.7927 #> ----------------------------------------- #> - Ecology == \"S\" #>  #> Optimal weights: #>        Weight      SE      SD Min. Max. #> hydro 0.85556 0.02422 0.07265  0.8  1.0 #> curve 0.05556 0.02422 0.07265  0.0  0.2 #> mech  0.05556 0.02422 0.07265  0.0  0.2 #> fea   0.03333 0.01667 0.05000  0.0  0.1 #>  #> Average fitness value at optimal weights: #>    Value       SE    SD   Min.   Max. #> Z 0.7496 0.005665 0.017 0.7326 0.7835 #> ----------------------------------------- #> - Ecology == \"T\" #>  #> Optimal weights: #>       Weight      SE     SD Min. Max. #> hydro   0.00 0.00000 0.0000  0.0  0.0 #> curve   0.85 0.06455 0.1291  0.7  1.0 #> mech    0.15 0.06455 0.1291  0.0  0.3 #> fea     0.00 0.00000 0.0000  0.0  0.0 #>  #> Average fitness value at optimal weights: #>    Value       SE      SD  Min.   Max. #> Z 0.7646 0.008862 0.01772 0.744 0.7852 #>  #> - method: chi-squared, quantile = 0.05 summary(wprime_by_Group) #> Optimal weights by Ecology: #>   W_hydro W_curve  W_mech   W_fea       Z #> M 0.15000 0.00000 0.00000 0.85000 0.76856 #> S 0.85556 0.05556 0.05556 0.03333 0.74959 #> T 0.00000 0.85000 0.15000 0.00000 0.76457 plot(wprime_by_Group, ncol = 2) tests <- multi.lands.grp.test(wprime_by_Group) tests #> Pairwise landscape group tests #> - method: chi-squared | quantile: 0.05 #>  #> Results: #>   M S T #> M - 0 0 #> S 0 - 0 #> T 0 0 - #> (lower triangle: p-values | upper triangle: number of matches)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/as_fnc_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a data frame to a fnc_df — as_fnc_df","title":"Convert a data frame to a fnc_df — as_fnc_df","text":"as_fnc_df() converts data frame containing coordinates functional charactertics morphological space  fnc_df object use later funcitons, importantly krige_surf.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/as_fnc_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a data frame to a fnc_df — as_fnc_df","text":"","code":"as_fnc_df(x, func.names = NULL, scale = TRUE)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/as_fnc_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a data frame to a fnc_df — as_fnc_df","text":"x data frame containing coordinates functional characteristics (possibly variables, ignored). first two columns must correspond x y coordinates warps morphological space. func.names names variables x correspond functional characteristics. charcteristics must numeric variables. NULL (default), variables first two taken functional characteristics study. scale whether scale functional characteristics minimum 0 maximum 1. generally left default (TRUE) unless variables already scaled.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/as_fnc_df.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert a data frame to a fnc_df — as_fnc_df","text":"Input data can sampled grid locations morphospace, measured specimen data, species group means, mix.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/as_fnc_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a data frame to a fnc_df — as_fnc_df","text":"fnc_df object, data.frame x y coordinates first two columns functional characteristics columns. \"func.names\"  attribute contains names functional characteristics.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/as_fnc_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a data frame to a fnc_df — as_fnc_df","text":"","code":"data(\"warps\")  warps_fnc <- as_fnc_df(warps,                         func.names = c(\"hydro\", \"curve\",                                        \"mech\", \"fea\"))                                         str(warps_fnc) #> Classes ‘fnc_df’ and 'data.frame':\t24 obs. of  6 variables: #>  $ x    : num  -0.189 -0.189 -0.189 -0.189 -0.134 ... #>  $ y    : num  -0.05161 -0.00363 0.04435 0.09233 -0.05161 ... #>  $ hydro: num  0.763 0.627 0.487 0.174 0.858 ... #>  $ curve: num  0.0544 0 0.1045 0.281 0.1202 ... #>  $ mech : num  0.359 0.473 0.446 0 0.149 ... #>  $ fea  : num  0.372 0.458 0.512 0.65 0.777 ... #>  - attr(*, \"func.names\")= chr [1:4] \"hydro\" \"curve\" \"mech\" \"fea\""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcGrpWprime.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute optimally weighted adaptive landscapes — calcGrpWprime","title":"Compute optimally weighted adaptive landscapes — calcGrpWprime","text":"calcGrpWprime() computes optimally weighted adaptive landscape searching adaptive landscapes formed sets weights performance surfaces, finding set weights yields greatest overall (average) fitness value (Z) across sample data subset thereof.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcGrpWprime.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute optimally weighted adaptive landscapes — calcGrpWprime","text":"","code":"calcGrpWprime(x, index, method = \"chi-squared\",               quantile = 0.05) # S3 method for grp_Wprime print(x,        digits = max(3L, getOption(\"digits\") - 3L), ...)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcGrpWprime.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute optimally weighted adaptive landscapes — calcGrpWprime","text":"x calcGrpWprime(), all_lscps object; output call calc_all_lscps. print(), grp_Wprime object; output call calcGrpWprime() index optional vector indices indicating subset new_data dataset originally supplied krige_surf calculated. Can specified vector numerical indicies, logical indices, row names. unspecified, optimal weights computed using full sample. Supplied subset, name dataset containing subsetting variable need included subsetting variable new_data. See Examples. method method used compute optimal weights. Allowable options include \"chi-square\" (default), \"quantile\", \"max\". \"chi-square\" \"quantile\" involve averaging across best several sets weights, whereas \"max\" uses singular best set weights. Abbreviations allowed. See Details. quantile method \"chi-square\" \"quantile\", top quantile used determine best sets weights included average compute optimal set weights. number 0 1, low value indicating top sets weights used. Ignored method = \"max\". digits number significant digits print. ... passed print.default.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcGrpWprime.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute optimally weighted adaptive landscapes — calcGrpWprime","text":"calcGrpWprime() calculates overall fitness score set weights based average weighted fitness values indexed subgroup. set weights optimizes score produced weights defining optimal adaptive landscape subgroup. way final set weights computed depends argument method. method = \"max\", single best set weights used. However, often many upper sets weights perform equally nearly equally well best set. instead recommended use \"quantile\" \"chi-squared\" methods. method = \"quantile\", top \\(X\\%\\) weights averaged compute optimal weights, \\(X\\) corresponds value supplied quantile. method = \"chi-square\",  chi-squared value \\(\\chi^2_i\\) computed set weights \\(\\) $$\\chi^2_i = -2 \\log \\frac{Z_{max}}{Z_i}$$ \\(Z_{max}\\) largest \\(Z\\) among weights, p-value computed \\(\\chi^2_i\\) value using \\(\\chi^2\\) distribution 2 d.f.; set weights p-value less quantile included averaged compute optimal set weights.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcGrpWprime.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute optimally weighted adaptive landscapes — calcGrpWprime","text":"grp_Wprime object, contains following components: Zprime list containing optimal weights Z value yield (wn), , method \"chi-square\" \"quantile\", summary statistics best sets weights used compute optimal weights, including standard error (wn.se), standard deviation (wn.sd), range (wn.range). W matrix containing sets weights (.e., supplied grid_weights argument calc_all_lscps()) along Z value yields, ordered descending order yielded Z value. index specified, resulting Z values computed using indexed subset. Wprime wtd_lscp object containing optimal weights (W) landscape grid sample functional characteristcs weighted optimal weights.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcGrpWprime.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute optimally weighted adaptive landscapes — calcGrpWprime","text":"Dickson, B. V., Clack, J. ., Smithson, T. R., & Pierce, S. E. (2021). Functional adaptive landscapes predict terrestrial capacity origin limbs. Nature, 589(7841), 242-245. Jones, K. E., Dickson, B. V., Angielczyk, K. D., & Pierce, S. E. (2021). Adaptive landscapes challenge \"lateral--sagittal\"\" paradigm mammalian vertebral evolution. Current Biology, 31(9), 1883-1892.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcGrpWprime.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute optimally weighted adaptive landscapes — calcGrpWprime","text":"","code":"data(\"warps\") data(\"turtles\")  warps_fnc <- as_fnc_df(warps,                         func.names = c(\"hydro\", \"fea\"))  kr_surf <- krige_surf(warps_fnc, new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging]  grid_weights <- generate_weights(n = 3, data = kr_surf) #> 4 rows generated  all_lscps <- calc_all_lscps(kr_surf,                             grid_weights = grid_weights)                              wprime_S <- calcGrpWprime(all_lscps,                           index = Ecology == \"S\") wprime_S #> Optimal weights: #>       Weight SE SD Min. Max. #> hydro      1 NA NA    1    1 #> fea        0 NA NA    0    0 #>  #> Average fitness value at optimal weights: #>    Value SE SD   Min.   Max. #> Z 0.7835 NA NA 0.7835 0.7835 #>  #> - method: chi-squared, quantile = 0.05 plot(wprime_S)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcWprimeBy.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute optimally weighted adaptive landscapes by subgroup — calcWprimeBy","title":"Compute optimally weighted adaptive landscapes by subgroup — calcWprimeBy","text":"calcWprimeBy() computes optimally weighted adaptive landscape searching adaptive landscapes formed sets weights performance surfaces, finding set weights yields greatest overall (average) fitness value (Z) across subsets sample dataset.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcWprimeBy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute optimally weighted adaptive landscapes by subgroup — calcWprimeBy","text":"","code":"calcWprimeBy(x, by, method = \"chi-squared\", quantile = 0.05)  # S3 method for by_Wprime print(x,        digits = max(3L, getOption(\"digits\") - 3L), ...)  # S3 method for by_Wprime summary(object, ...)  # S3 method for summary.by_Wprime print(x,        digits = max(3L, getOption(\"digits\") - 3L), ...)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcWprimeBy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute optimally weighted adaptive landscapes by subgroup — calcWprimeBy","text":"x calcWprimeBy(), all_lscps object; output call calc_all_lscps. print.by_Wprime(), by_Wprime object; output call calcWprimeBy(). print.summary.by_Wprime(), by_Wprime object; output call summary.by_Wprime(). one-sided formula containing grouping variable right hand side (e.g., ~g) vector containing subgrouping variable. supplied formula, grouping variable must present global environment new_data component kriged_surfaces object originally supplied calc_all_lscps(). method method used compute optimal weights. Allowable options include \"chi-square\" (default), \"quantile\", \"max\". \"chi-square\" \"quantile\" involve averaging across best several sets weights, whereas \"max\" uses singular best set weights. Abbreviations allowed. See calcGrpWprime details. quantile method \"chi-square\" \"quantile\", top quantile used determine best sets weights included average compute optimal set weights. number 0 1, low value indicating top sets weights used. Ignored method = \"max\". See calcGrpWprime details. digits number significant digits print. ... passed print.default print.table. object by_Wprime object; output call calcWprimeBy().","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcWprimeBy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute optimally weighted adaptive landscapes by subgroup — calcWprimeBy","text":"calcWprimeBy() splits sample data based variable calls calcGrpWprime subset. main benefit using calcWprimeBy() subgrouping variable part output object therefore can used plotting using plot.by_Wprime.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcWprimeBy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute optimally weighted adaptive landscapes by subgroup — calcWprimeBy","text":"by_Wprime object contaning following components: subgrouping variable supplied , stored factor \"by_name\" attribute containing name variable. grp_Wprimes list grp_Wprime objects, one level subgrouping variable.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/calcWprimeBy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute optimally weighted adaptive landscapes by subgroup — calcWprimeBy","text":"","code":"data(\"warps\") data(\"turtles\")  warps_fnc <- as_fnc_df(warps,                         func.names = c(\"hydro\", \"fea\"))  kr_surf <- krige_surf(warps_fnc, new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging]  grid_weights <- generate_weights(n = 3, data = kr_surf) #> 4 rows generated  all_lscps <- calc_all_lscps(kr_surf,                             grid_weights = grid_weights)                              wprime_Ecology <- calcWprimeBy(all_lscps, by = ~Ecology) wprime_Ecology #> - Ecology == \"M\" #>  #> Optimal weights: #>       Weight SE SD Min. Max. #> hydro      0 NA NA    0    0 #> fea        1 NA NA    1    1 #>  #> Average fitness value at optimal weights: #>    Value SE SD   Min.   Max. #> Z 0.7927 NA NA 0.7927 0.7927 #> ----------------------------------------- #> - Ecology == \"S\" #>  #> Optimal weights: #>       Weight SE SD Min. Max. #> hydro      1 NA NA    1    1 #> fea        0 NA NA    0    0 #>  #> Average fitness value at optimal weights: #>    Value SE SD   Min.   Max. #> Z 0.7835 NA NA 0.7835 0.7835 #> ----------------------------------------- #> - Ecology == \"T\" #>  #> Optimal weights: #>       Weight     SE     SD Min. Max. #> hydro    0.5 0.2152 0.4303    0    1 #> fea      0.5 0.2152 0.4303    0    1 #>  #> Average fitness value at optimal weights: #>   Value       SE       SD   Min.   Max. #> Z 0.218 0.001605 0.003211 0.2142 0.2217 #>  #> - method: chi-squared, quantile = 0.05 summary(wprime_Ecology) #> Optimal weights by Ecology: #>   W_hydro  W_fea      Z #> M  0.0000 1.0000 0.7927 #> S  1.0000 0.0000 0.7835 #> T  0.5000 0.5000 0.2180 plot(wprime_Ecology)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_all_lscps.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate adaptive landscapes for a matrix of weights — calc_all_lscps","title":"Calculate adaptive landscapes for a matrix of weights — calc_all_lscps","text":"calc_all_lscps() calculates adaptive landscapes set kriged surfaces functional characteristics sets weights characteristics.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_all_lscps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate adaptive landscapes for a matrix of weights — calc_all_lscps","text":"","code":"calc_all_lscps(kr_data, grid_weights, file = NULL)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_all_lscps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate adaptive landscapes for a matrix of weights — calc_all_lscps","text":"kr_data kriged_surfaces object; output call krige_surf. grid_weights grid_weights object; output call generate_weights. file path file save resulting output object, may quite large. file path contain .rds .rdata extension, saved using saveRDS save, respectively. See Details load files saving .","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_all_lscps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate adaptive landscapes for a matrix of weights — calc_all_lscps","text":"calc_all_lscps() computes combined adaptive landscape supplied sets weights. optimal landscape overall certain subsets sample data can found using calcGrpWprime calcWprimeBy. calc_lscp can used extract surface weighted functional characteristics set weights (see Examples). resulting objects large, can good idea save creation, can done automatically using file argument. supplied file extension .rds, saveRDS used save object supplied file path, file can loaded using readRDS. supplied file extension .RData, save used save object supplied file path, file can loaded using load.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_all_lscps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate adaptive landscapes for a matrix of weights — calc_all_lscps","text":"all_lscps object containing following components: dataframe list grid new_data data frames stored kr_data. wtd_lscps list containing weightred fitness values set weights grid new_data datasets. stored matrices row data point grid new_data column set weights. grid_weights grid_weights object supplied grid_weights.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_all_lscps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate adaptive landscapes for a matrix of weights — calc_all_lscps","text":"","code":"data(\"warps\") data(\"turtles\")  warps_fnc <- as_fnc_df(warps,                         func.names = c(\"hydro\", \"fea\"))  kr_surf <- krige_surf(warps_fnc, new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging]  grid_weights <- generate_weights(n = 20, data = kr_surf) #> 21 rows generated  all_lscps <- calc_all_lscps(kr_surf,                             grid_weights = grid_weights) all_lscps #> An all_lscps object #> - functional characteristics: #> \thydro, fea #> - number of landscapes: #> \t21 #> - weights incremented by: #> \t0.05 #> - new data: #> \t40 rows  # Extract the weighted surface for a single set # of weights (here, the 6th set of weights)  grid_weights[6,] #> hydro   fea  #>  0.75  0.25   wtd_lscp_6 <- calc_lscp(all_lscps, i = 6) wtd_lscp_6 #> A wtd_lscp object #> - weights: #> hydro   fea  #>  0.75  0.25  #> - new data: #> \t40 rows #> \taverage Z = 0.623  # This aligns with the weighted fitness value: mean(all_lscps$wtd_lscps$new_data[,6]) #> [1] 0.6226965"},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_lscp.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a single weighted adaptive landscape — calc_lscp","title":"Calculate a single weighted adaptive landscape — calc_lscp","text":"calc_lscp() calculates single weighted landscape set kriged surfaces functional characteristics set weights characteristics. landscape can plotted using plot.wtd_lscp. Additionally computes fitness values sample additional coordinates.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_lscp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a single weighted adaptive landscape — calc_lscp","text":"","code":"calc_lscp(data, weights, ...)  # S3 method for kriged_surfaces calc_lscp(data, weights, ...)  # S3 method for all_lscps calc_lscp(data, weights, i, ...)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_lscp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a single weighted adaptive landscape — calc_lscp","text":"data kriged_surfaces all_lscps object; output call krige_surf calc_all_lscps, repsectively. new_data component included data, adaptive landscape produced. weights vector weights, one functional characteristic. weights nonnegative sum 1. data all_lscps object, index set weights grid_weights object supplied calc_all_lscps() use create weighted landscape. ... ignored.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_lscp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate a single weighted adaptive landscape — calc_lscp","text":"calc_lscp() operates kriged surfaces stored data multiplying functional characteristic values point surface grid weights computing sum values arrive \"fitness\" value represented maximum height combined adaptive landscape. new_data component present data (e.g., new_data argument supplied krige_surf() data output call krige_new_data()), weighted fitness values computed coordinates new_data well.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_lscp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a single weighted adaptive landscape — calc_lscp","text":"wtd_lscp object, contains following components: W named vector supplied weights Wprime list containing weighted grid new_data components data, values functional characteristics location surface weighted supplied weights additiona column, Z, added containing height adaptive landscape point.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/calc_lscp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate a single weighted adaptive landscape — calc_lscp","text":"","code":"data(\"warps\")  warps_fnc <- as_fnc_df(warps, func.names = c(\"hydro\", \"fea\"))  kr_surf <- krige_surf(warps_fnc) #> [using ordinary kriging] #> [using ordinary kriging]  weights <- c(hydro = .5, fea = .5)  w_lscp <- calc_lscp(kr_surf, weights = weights)  plot(w_lscp)   # Adding new_data data(\"turtles\") kr_surf <- krige_new_data(kr_surf, new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging]  w_lscp <- calc_lscp(kr_surf, weights = weights) w_lscp #> A wtd_lscp object #> - weights: #> hydro   fea  #>   0.5   0.5  #> - new data: #> \t40 rows #> \taverage Z = 0.575 plot(w_lscp)   ## See further use with calc_all_lscps()  ## at help(\"calc_all_lscps\")"},{"path":"https://blakedickson.github.io/Morphoscape/reference/generate_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a matrix containing weight combinations — generate_weights","title":"Generate a matrix containing weight combinations — generate_weights","text":"generate_weights() generates matrix containing weight combinations set variables set weights sums 1. can supplied calc_all_lscps calculate fitness landscapes corresponding variety possible sets weights weighting functional characteristics. weights generated partitioning weight 1 across however many variables requested possible ways.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/generate_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a matrix containing weight combinations — generate_weights","text":"","code":"generate_weights(step, n, data = NULL, nvar = NULL,                  varnames = NULL, verbose = TRUE)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/generate_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a matrix containing weight combinations — generate_weights","text":"step numeric. step size weight partitions. one step n can specified. n numeric. number weight partitions 0-1. one step n can specified. data optional fnc_df (output as_fnc_df) kriged_surfaces (output krige_surf) object. number variabes names extracted data functional characteristics present . nvar number variables across allocate weights. Ignored data NULL. nvar = NULL varnames supplied, length varnames used nvar. varnames names variables across allocate weights. Ignored data NULL. varnames = NULL nvar supplied, sequence 1 nar used varnames. verbose whether display message noting number sets weights created.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/generate_weights.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate a matrix containing weight combinations — generate_weights","text":"generate_weights() works fining possible allocations n objects nvar bins. step supplied, n computed round(1/step), resulting weight partitions may exactly equal step inverse integer. larger n (smaller step) , possible allocations produced (.e., resulting object rows). output generate_weights() can quickly become large increasing number variables, make subsequent analyses slow. recommended start large step size, small n, increment .","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/generate_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a matrix containing weight combinations — generate_weights","text":"grid_weights object, matrix row set weights column variable weights allocated. weights row sum 1.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/generate_weights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a matrix containing weight combinations — generate_weights","text":"","code":"# Allocating 10 partitions of .1 across 3 variables wmat <- generate_weights(n = 10, nvar = 3) #> 66 rows generated head(wmat) #>        1   2 3 #> [1,] 1.0 0.0 0 #> [2,] 0.9 0.1 0 #> [3,] 0.8 0.2 0 #> [4,] 0.7 0.3 0 #> [5,] 0.6 0.4 0 #> [6,] 0.5 0.5 0  # Allocating 5 partitions of .2 across the 4 functional # characteristics in the warps dataset data(\"warps\")  warps_fnc <- as_fnc_df(warps) wmat <- generate_weights(n = 5, data = warps_fnc) #> 56 rows generated head(wmat) #>      hydro curve mech fea #> [1,]   1.0   0.0    0   0 #> [2,]   0.8   0.2    0   0 #> [3,]   0.6   0.4    0   0 #> [4,]   0.4   0.6    0   0 #> [5,]   0.2   0.8    0   0 #> [6,]   0.0   1.0    0   0  # Using 'step' for the same result: wmat <- generate_weights(step = .2, data = warps_fnc) #> 56 rows generated head(wmat) #>      hydro curve mech fea #> [1,]   1.0   0.0    0   0 #> [2,]   0.8   0.2    0   0 #> [3,]   0.6   0.4    0   0 #> [4,]   0.4   0.6    0   0 #> [5,]   0.2   0.8    0   0 #> [6,]   0.0   1.0    0   0"},{"path":"https://blakedickson.github.io/Morphoscape/reference/krige_surf.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate functional characteristics over a grid — krige_surf","title":"Interpolate functional characteristics over a grid — krige_surf","text":"krige_surf() performs kriging (.e., interpolation) one functional characteristics spatially distributed morphospace create smoothly kriged surface. Interpolated values can also produced new dataset given coordinates morphological space.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/krige_surf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate functional characteristics over a grid — krige_surf","text":"","code":"krige_surf(fnc_df, grid = NULL, resample = 100,            padding = 1.2, hull = TRUE, alpha = 1,            new_data = NULL)             krige_new_data(x, new_data)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/krige_surf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate functional characteristics over a grid — krige_surf","text":"fnc_df fnc_df object; output call as_fnc_df, contains coordinates morphological space values functional characteristics warps used create kriged surface. grid matrix data frame containing grid points surface interpolated. output call resample_grid. NULL, grid formed calling resample_grid() inputs. resample number points (pixels) x y dimensions create grid. Default 100 kriged surface 100x100=10,000 pixels. Passed resample_grid. Ignored grid NULL. padding number representing much expand grid beyond ranges x- y-coordinates. example, padding = 1.2 (default) expands grid 20% coordinates' ranges direction. Must number greater equal 1. Large numbers imply greater extrapolation, whatever padding added negated hull = TRUE. Passed resample_grid. Ignored grid NULL. hull whether restrict kriging alpha hull prevent extrapolation beyond coordinates present fnc_df. Passed resample_grid, uses alphahull::ahull. Default TRUE. FALSE, kriging take place rectangular grid spans boundaries coordinates fnc_df. Ignored grid NULL. alpha alpha value used create alpha hull. Passed resample_grid eventually alphahull::ahull. Ignored grid NULL. new_data dataset coordinates new sample; values functional characteristics sample interpolated using kriged surface. x \"kriged_surfaces\" object; output call krige_surf().","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/krige_surf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Interpolate functional characteristics over a grid — krige_surf","text":"krige_surf() implements automap::autoKrige function one spatially distributed traits produce interpolated (extrapolated) surface evenly spaced gridpoints. done automatiically finding best variogram fit non-corrdinate variables fnc_df. details automatic variogram fitting, see automap::autoKrige. Input data fnc_df can unevenly distributed (direct speciments), gridded (determined evenly distributed hypothetical shapes) morphospace. Trait data inputted directly specimen measurements subject error based unevenly points distributed, high resoultion gridded datapoints producing least potential reconstruction error (see Smith et al 2021). default krige_surf create hull strictly prevent extrapolation beyond provided data. produce conservative landscapes. hull set FALSE, function reconstruct rectangle determined XY coordinate ranges supplied fnc_df. Padding applied default (extra 20%) defined padding, expand rectangle beyond supplied points. Reconstructions without hull appropriate trait data determined evenely spaced hypothetical gridpoints. grid provided function strictly interpolate gridded points. krige_new_data() adds new data set supplied kriged_surfaces object interpolates values functional characteristics suppllied sample. used add new dataset kriged_surfaces object produced without new_data supplied replace existing new_data component.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/krige_surf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate functional characteristics over a grid — krige_surf","text":"object class kriged_surfaces containing following components: fnc_df original data frame functional characteristics passed fnc_df. autoKrige named list kriged surfaces, one functional characteristic. surface class autoKrige, output call automap::autoKrige. dataframes list two data frames, grid new_data. grid contains coordinates kriged surface grid (x y columns) well interpolated values functional characteristics. new_data contains sample coordinates supplied new_data well interpolated values functional characteristics sample. second component absent new_data = NULL call krige_surf(). krige_new_data(), original kriged_surfaces object, $dataframes$new_data component containing sample coordinates supplied new_data well interpolated values functional characteristics sample.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/krige_surf.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Interpolate functional characteristics over a grid — krige_surf","text":"Smith, S. M., Stayton, C. T., & Angielczyk, K. D. (2021). many trees see forest? Assessing effects morphospace coverage sample size performance surface analysis. Methods Ecology Evolution, 12(8), 1411-1424.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/krige_surf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interpolate functional characteristics over a grid — krige_surf","text":"","code":"data(\"warps\")  warps_fnc <- as_fnc_df(warps)  grid <- resample_grid(warps)  kr_surf <- krige_surf(warps_fnc, grid = grid) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] kr_surf #> A kriged_surfaces object #> - functional characteristics: #> \thydro, curve, mech, fea #> - surface size: #> \t70 by 70 #> \tα-hull applied (α = 1) #> - original data: #> \t24 rows  # Add new data data(\"turtles\") kr_surf <- krige_new_data(kr_surf, new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] kr_surf #> A kriged_surfaces object #> - functional characteristics: #> \thydro, curve, mech, fea #> - surface size: #> \t70 by 70 #> \tα-hull applied (α = 1) #> - original data: #> \t24 rows #> - new data: #> \t40 rows plot(kr_surf)   # Doing it all in one step: if (FALSE) { kr_surf <- krige_surf(warps_fnc, new_data = turtles) kr_surf }"},{"path":"https://blakedickson.github.io/Morphoscape/reference/lands.grp.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Significance tests between sets of weights — lands.grp.test","title":"Significance tests between sets of weights — lands.grp.test","text":"lands.grp.test() performs statistical test whether optimal adaptive landscape two subgroups significantly different . p-value test proportion weight sets shared two subgroups among respective top weight sets. multi.lands.grp.test() performs test pairs subgroups.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/lands.grp.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Significance tests between sets of weights — lands.grp.test","text":"","code":"lands.grp.test(grpa, grpb, method = \"chi-squared\",                quantile = 0.05)  multi.lands.grp.test(x, method = \"chi-squared\",                      quantile = 0.05)  # S3 method for lands.grp.test print(x, digits = max(3L, getOption(\"digits\") - 3L), ...)  # S3 method for multi.lands.grp.test print(x, digits = max(3L, getOption(\"digits\") - 3L),        style = \"matrix\", ...)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/lands.grp.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Significance tests between sets of weights — lands.grp.test","text":"grpa, grpb lands.grp.test(), two grp_Wprime objects containing adaptive landscapes compared; output calls calcGrpWprime. x multi.lands.grp.test(), by_Wprime object, output call calcWprimeBy. print(), output call lands.grp.test() multi.lands.grp.test(). method method used determine sets weights \"best\" sets weights comapred two groups. Allowable options include \"chi-squared\" \"quantile\". See calcGrpWprime details. quantile top quantile used determine best sets weights included average compute optimal set weights. number 0 1, low value indicating top sets weights used. See calcGrpWprime details. digits number significant digits print. style display results pairwise tests; allowable options include \"matrix\" \"table\". Abbreviations allowed. ... passed print.default.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/lands.grp.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Significance tests between sets of weights — lands.grp.test","text":"lands.grp.test() performs pairwise comparisons two adaptive groups comparing number shared landscapes \\(n_{+B}\\) top percentile group total number landscapes top percentile \\(n_{total}\\). probability \\(P(=B)\\) thus calculated : $$ P(=B) = n_{+B}/n_{total} $$ method = \"quantile\" used, top percentile defined quantile. method = \"chi-squared\" used, top percentile calculated chi-squared value \\(\\chi^2_i\\) : $$\\chi^2_i = -2 \\log \\frac{Z_{max}}{Z_i}$$ \\(Z_{max}\\) largest \\(Z\\) among weights, p-value computed \\(\\chi^2_i\\) value using \\(\\chi^2\\) distribution 2 d.f.; set weights p-value less quantile included optimal set weights. multi.lands.grp.test() wrapper lands.grp.test(), applying function pairwise combinations groups calculated calcWprimeBy.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/lands.grp.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Significance tests between sets of weights — lands.grp.test","text":"lands.grp.test(), lands.grp.test object containing following components: n.match number sets weights match two supplied subgroups p.val p-value test, computed number sets weights match divided number sets weights compared matching matrix containing sets weights match two subgroups method argument supplied method quantile argument supplied quantile multi.lands.grp.test(), multi.lands.grp.test object containing following components: res data frame containing results tests, columns Group Group B indicating groups involved comparison, column Matches containing number matching sets weights comparison, column p value containing p-value test. method argument supplied method quantile argument supplied quantile print.multi.lands.grp.test(), setting style = \"table\" prints res component -; setting style = \"matrix\" creates matrix p-values test diagonal number matches test diagonal.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/lands.grp.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Significance tests between sets of weights — lands.grp.test","text":"Jones, K. E., Dickson, B. V., Angielczyk, K. D., & Pierce, S. E. (2021). Adaptive landscapes challenge \"lateral--sagittal\"\" paradigm mammalian vertebral evolution. Current Biology, 31(9), 1883-1892.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/lands.grp.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Significance tests between sets of weights — lands.grp.test","text":"","code":"data(\"warps\") data(\"turtles\")  warps_fnc <- as_fnc_df(warps,                         func.names = c(\"hydro\", \"fea\"))  kr_surf <- krige_surf(warps_fnc, new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging]  grid_weights <- generate_weights(n = 3, data = kr_surf) #> 4 rows generated  all_lscps <- calc_all_lscps(kr_surf,                             grid_weights = grid_weights)  # Comparing adaptive landscapes of Ecology groups S and M wprime_S <- calcGrpWprime(all_lscps,                           index = Ecology == \"S\") wprime_M <- calcGrpWprime(all_lscps,                           index = Ecology == \"M\") lands.grp.test(wprime_S, wprime_M) #> Landscape group test #> - method: chi-squared | quantile: 0.05 #>  #> Number of matches: 0 #> P-value: 0  # Comparing adaptive landscapes of all Group subgroups wprime_by_Group <- calcWprimeBy(all_lscps, by = ~Group) tests <- multi.lands.grp.test(wprime_by_Group) tests #> Pairwise landscape group tests #> - method: chi-squared | quantile: 0.05 #>  #> Results: #>            box turtle brackish fathead freshwater sea turtle softshell tortoise #> box turtle -          1        2       1          1          1         2        #> brackish   0.25       -        1       1          0          1         0        #> fathead    0.5        1        -       1          0          1         0        #> freshwater 0.25       1        0.5     -          0          1         0        #> sea turtle 0.25       0        0       0          -          0         1        #> softshell  0.25       1        0.5     1          0          -         0        #> tortoise   0.5        0        0       0          1          0         -        #> (lower triangle: p-values | upper triangle: number of matches) print(tests, style = \"table\") #> Pairwise landscape group tests #> - method: chi-squared | quantile: 0.05 #>  #> Results: #>       Group A    Group B Matches p value #> 1  box turtle   brackish       1    0.25 #> 2  box turtle    fathead       2    0.50 #> 3  box turtle freshwater       1    0.25 #> 4  box turtle sea turtle       1    0.25 #> 5  box turtle  softshell       1    0.25 #> 6  box turtle   tortoise       2    0.50 #> 7    brackish    fathead       1    1.00 #> 8    brackish freshwater       1    1.00 #> 9    brackish sea turtle       0    0.00 #> 10   brackish  softshell       1    1.00 #> 11   brackish   tortoise       0    0.00 #> 12    fathead freshwater       1    0.50 #> 13    fathead sea turtle       0    0.00 #> 14    fathead  softshell       1    0.50 #> 15    fathead   tortoise       0    0.00 #> 16 freshwater sea turtle       0    0.00 #> 17 freshwater  softshell       1    1.00 #> 18 freshwater   tortoise       0    0.00 #> 19 sea turtle  softshell       0    0.00 #> 20 sea turtle   tortoise       1    1.00 #> 21  softshell   tortoise       0    0.00"},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.kriged_surfaces.html","id":null,"dir":"Reference","previous_headings":"","what":"Plots Kriged surfaces of functional characteristics — plot.kriged_surfaces","title":"Plots Kriged surfaces of functional characteristics — plot.kriged_surfaces","text":"plot.kriged_surfaces() produces spatial landscape plots kriged surfaces produced krige_surf.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.kriged_surfaces.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plots Kriged surfaces of functional characteristics — plot.kriged_surfaces","text":"","code":"# S3 method for kriged_surfaces plot(x, alpha = 0.5, pt.col = \"black\",      interpolate = TRUE, contour = TRUE, ...)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.kriged_surfaces.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plots Kriged surfaces of functional characteristics — plot.kriged_surfaces","text":"x kriged_surfaces object; output call krige_surf. alpha, pt.col new_data component present x, transparency (alpha) color (pt.col) points plotted new samples. interpolate logical; whether smooth plot interpolating across pixels grid. Passed ggplot2::geom_raster. contour logical; whether add contour lines plot illustrate changes fitness landscape. ... ignored.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.kriged_surfaces.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plots Kriged surfaces of functional characteristics — plot.kriged_surfaces","text":"plot.kriged_surfaces() wrapper ggplot2 raster plotting functions. precise control raster plotting see ggplot2::geom_raster.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.kriged_surfaces.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plots Kriged surfaces of functional characteristics — plot.kriged_surfaces","text":"ggplot object, can manipulated using ggplot2 functionality.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.kriged_surfaces.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plots Kriged surfaces of functional characteristics — plot.kriged_surfaces","text":"","code":"# See examples at help(\"krige_surf\")"},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.wtd_lscp.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Adaptive Landscapes — plot.wtd_lscp","title":"Plot Adaptive Landscapes — plot.wtd_lscp","text":"plot plot methods plot adaptive landscape, weighted combination functional surfaces. landscape arise calls calc_lscp, calc_all_lscps, calcGrpWprime, calcWprimeBy.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.wtd_lscp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Adaptive Landscapes — plot.wtd_lscp","text":"","code":"# S3 method for wtd_lscp plot(x, alpha = 1, pt.col = \"black\",       interpolate = TRUE, contour = TRUE, ...) # S3 method for grp_Wprime plot(x, alpha = 1, pt.col = \"black\",       interpolate = TRUE, contour = TRUE, ...) # S3 method for by_Wprime plot(x, level, ncol = 1, alpha = 1,      pt.col = \"black\", interpolate = TRUE, contour = TRUE,       ...)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.wtd_lscp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Adaptive Landscapes — plot.wtd_lscp","text":"x wtd_lscp, grp_Wprime, by_Wprime object, output call calc_lscp, calcGrpWprime, calcWprimeBy, respectively. alpha transparency points data sample. number 0 (fully transparent) 1 (fully opaque). Passed ggplot2::geom_point. pt.col color points data sample. Passed ggplot2::geom_point. interpolate whether interpolate across pixels grid. Passed ggplot2::geom_raster. contour whether display contours grid. level level (subgrouping) variable plotted. missing, plotted. ncol multiple subgroups plotted, many columns plots arranged. ... ignored.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.wtd_lscp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Adaptive Landscapes — plot.wtd_lscp","text":"plotting functions wrappers ggplot2 raster plotting functions. precise control raster plotting see ggplot2::geom_raster.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.wtd_lscp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Adaptive Landscapes — plot.wtd_lscp","text":"ggplot object can adjusted using functions ggplot2.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/plot.wtd_lscp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Adaptive Landscapes — plot.wtd_lscp","text":"","code":"data(\"warps\") data(\"turtles\")  warps_fnc <- as_fnc_df(warps, func.names = c(\"hydro\", \"fea\"))  kr_surf <- krige_surf(warps_fnc, new_data = turtles) #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging] #> [using ordinary kriging]  weights <- c(hydro = .5, fea = .5)  w_lscp <- calc_lscp(kr_surf, weights = weights)  plot(w_lscp)  plot(w_lscp, countour = FALSE, pt.col = \"white\")   # See help(\"calc_lscp\"), help(\"calcGrpWprime\"), and  # help(\"calcWprimeBy\") for examples when used with # those functions"},{"path":"https://blakedickson.github.io/Morphoscape/reference/resample_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a full grid from a set of coordinates — resample_grid","title":"Create a full grid from a set of coordinates — resample_grid","text":"resample_grid() creates rectangular grid around supplied coordinates resampling evenly spaced points minimum maximum values coordinate dimension. grid can optionally reduced alpha hull around supplied coordinates.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/resample_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a full grid from a set of coordinates — resample_grid","text":"","code":"resample_grid(coords2D, resample = 100, padding = 1.2,               hull = TRUE, alpha = 1, plot = FALSE)"},{"path":"https://blakedickson.github.io/Morphoscape/reference/resample_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a full grid from a set of coordinates — resample_grid","text":"coords2D 2-column matrix data frame coordinates x-coordinates first column y-coordinates second column. ranges column used create resampled grid. resample number points (pixels) x y dimensions create grid. Default 100 kriged surface 100x100=10,000 pixels. padding number representing much expand grid beyond ranges x- y-coordinates. example, padding = 1.2 (default) expands grid 20% coordinates' ranges direction. Must number greater equal 1. Large numbers imply greater extrapolation, whatever padding added negated hull = TRUE. hull whether restrict grid alpha hull using alphahull::ahull. Default TRUE. alpha hull = TRUE, alpha value used create hull. Passed alphahull::ahull. plot hull = TRUE, whether plot resulting hull overlayed original grid. Default TRUE.","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/resample_grid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a full grid from a set of coordinates — resample_grid","text":"data frame two columns, x y, containing resampled coordinate grid. hull = TRUE, points hull absent.","code":""},{"path":[]},{"path":"https://blakedickson.github.io/Morphoscape/reference/resample_grid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a full grid from a set of coordinates — resample_grid","text":"","code":"data(\"warps\")  warps_fnc <- as_fnc_df(warps)  # Alpha hull with plot to see the hull grid <- resample_grid(warps_fnc[c(\"x\", \"y\")],                       hull = TRUE, plot = TRUE)  str(grid) #> 'data.frame':\t4900 obs. of  2 variables: #>  $ x: num  -0.186 -0.182 -0.178 -0.174 -0.17 ... #>  $ y: num  -0.0499 -0.0499 -0.0499 -0.0499 -0.0499 ... #>  - attr(*, \"hull\")= logi TRUE #>  - attr(*, \"alpha\")= num 1"},{"path":"https://blakedickson.github.io/Morphoscape/reference/turtles.html","id":null,"dir":"Reference","previous_headings":"","what":"Turtle Humeri — turtles","title":"Turtle Humeri — turtles","text":"dataset containing sample 40 turtle humeri used Dickson Pierce (2019).","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/turtles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Turtle Humeri — turtles","text":"","code":"data(\"turtles\")"},{"path":"https://blakedickson.github.io/Morphoscape/reference/turtles.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Turtle Humeri — turtles","text":"data frame 40 observations following 4 variables. x first axis shape variation determiend -groups principal components analysis y second axis shape variation determiend -groups principal components analysis Group locomotor ecologies turtles Ecology three ecological groups determined Procrustes ANOVA; \"M\" (marine), \"S\" (semiaquatic), \"T\" (terrestrial)","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/turtles.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Turtle Humeri — turtles","text":"Dickson, B.V. Pierce, S.E. (2019), Functional performance turtle humerus shape across ecological adaptive landscape. Evolution, 73: 1265-1277. doi:10.1111/evo.13747","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/warps.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Shape Warps — warps","title":"Simulated Shape Warps — warps","text":"Trait data simulated shape warps turtle humeri used study morphological evolution turtles Dickson Pierce (2019). morphospace defined geometric morphometric analyises 1028 psuedolandmarks 40 turtle humeri. Hypothetical shape warps produced 4x6 grid accross morphospace. shape warp, four functional traits measured, corresponding locomotory performance trait: stress simulated load (strength), bone curvature (stride length), muscular mechanical advantage (mechanical advantage), frontal area (hydrodynamics).","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/warps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated Shape Warps — warps","text":"","code":"data(\"warps\")"},{"path":"https://blakedickson.github.io/Morphoscape/reference/warps.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated Shape Warps — warps","text":"data frame 24 observations following 6 variables. x first axis shape variation determiend -groups principal components analysis turtles dataset y second axis shape variation determiend -groups principal components analysis turtles dataset hydro hydrodynamics curve stride length mech mechanical advantage fea strength (assessed using finite element analysis)","code":""},{"path":"https://blakedickson.github.io/Morphoscape/reference/warps.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Simulated Shape Warps — warps","text":"Dickson, B.V. Pierce, S.E. (2019), Functional performance turtle humerus shape across ecological adaptive landscape. Evolution, 73: 1265-1277. doi:10.1111/evo.13747","code":""},{"path":"https://blakedickson.github.io/Morphoscape/news/index.html","id":"morphoscape-100","dir":"Changelog","previous_headings":"","what":"Morphoscape 1.0.0","title":"Morphoscape 1.0.0","text":"Full release new functions documentation. changes may compatible prior versions. Added NEWS.md file track changes package.","code":""}]
